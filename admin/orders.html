
<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="後台訂單管理頁（僅限管理員）。">
<meta name="robots" content="noindex,nofollow">
<link rel="canonical" href="https://unalomecodes.com/admin/orders">
<title>unalomecodes | 懂玩泰國 - 後台 orders</title>
<link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16.png">
<link rel="stylesheet" href="/css/admin-orders.inline-1.css">
<script src="/js/admin-orders.inline-1.js"></script>
<script src="/js/admin-guard.js" defer></script>
<link rel="stylesheet" href="/admin/admin-ui.css">
<script src="/js/admin-shell.js" defer></script>
<script src="/js/fflate.min.js"></script>
</head>
<body>
  <div class="wrap">
    <div class="backLink"><a class="backBtn" href="/admin">← 返回主選單</a></div>
    <h1>實體商品訂單管理</h1>
    <div class="tabs" id="statusTabs">
      <button class="tab-btn active" data-tab="all">全部 <span class="tab-count" data-tab="all">0</span></button>
      <button class="tab-btn" data-tab="pending">訂單待處理 <span class="tab-count" data-tab="pending">0</span></button>
      <button class="tab-btn" data-tab="ready">待出貨 <span class="tab-count" data-tab="ready">0</span></button>
      <button class="tab-btn" data-tab="shipped">已寄件 <span class="tab-count" data-tab="shipped">0</span></button>
      <button class="tab-btn" data-tab="done">已取件（訂單完成） <span class="tab-count" data-tab="done">0</span></button>
      <button class="tab-btn" data-tab="cancel">取消訂單 <span class="tab-count" data-tab="cancel">0</span></button>
    </div>
<div class="bar">
      <input id="q" placeholder="搜尋 訂單編號 / 商品 / email / 門市 ...">
      <select id="statusSel">
        <option value="">全部狀態</option>
        <option value="訂單待處理">訂單待處理</option>
        <option value="待出貨">待出貨</option>
        <option value="已寄件">已寄件</option>
        <option value="付款逾期">付款逾期</option>
        <option value="已取件（訂單完成）">已取件（訂單完成）</option>
        <option value="取消訂單">取消訂單</option>
      </select>
      <select id="sortSel"><option value="time_desc">時間：新 → 舊</option><option value="time_asc">時間：舊 → 新</option><option value="amt_desc">金額：高 → 低</option><option value="amt_asc">金額：低 → 高</option><option value="status">狀態</option></select>
      <button class="btn" id="reload">重新整理</button>
      <span class="muted" id="count"></span>
    </div>

    <div class="selbar">
      <button class="btn gold" id="markPaid">批次標記待出貨</button>
      <button class="btn gold" id="markShipped">批次標記已寄件</button>
      <button class="btn gold" id="markDone">批次標記已取件（訂單完成）</button>
      <button class="btn danger" id="batchDelete">批次刪除</button>
      <button class="btn" id="releaseHolds">手動釋放逾期</button>
      <button class="btn" id="exportCsv">匯出選取訂單（CSV）</button>
      <button class="btn" id="export711">匯出選取訂單（7-11 XLSM）</button>
      <span class="muted">已選取 <span class="count" id="selCount">0</span> 筆</span>
    </div>

    <div class="card">
      <div class="grid">
        <div style="overflow:auto; max-height:70vh;">
          <table id="tbl">
            <thead>
              <tr>
                <th style="width:36px"><input class="checkbox" type="checkbox" id="checkAll"></th>
                <th style="min-width:220px">訂單編號 / 建立時間</th>
                <th style="min-width:260px">商品</th>
                <th style="min-width:120px">金額</th>
                <th style="min-width:200px">付款</th>
                <th style="min-width:240px">訂購人資訊</th>
                <th style="min-width:140px">狀態</th>
                <th style="min-width:160px">單筆操作</th>
              </tr>
            </thead>
            <tbody id="tbody"></tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <dialog id="qnaDialog" class="qna-dialog">
    <div class="qna-head">
      <strong id="qnaTitle">訂單問與答</strong>
      <button type="button" class="btn" id="qnaClose">✕</button>
    </div>
    <div class="qna-body">
      <div class="qna-list" id="qnaList"></div>
      <div class="qna-form">
        <textarea id="qnaInput" placeholder="輸入回覆內容..."></textarea>
        <button type="button" class="btn gold" id="qnaSend">送出回覆</button>
      </div>
    </div>
  </dialog>

  
<script src="/js/admin-orders.inline-2.js"></script>

<!-- LINE客服橫幅樣式 -->
<link rel="stylesheet" href="/css/admin-orders.inline-2.css">

<div id="imgLightbox" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,.92);z-index:99999;align-items:center;justify-content:center;padding:20px">
  <img id="imgLightboxImg" src="" style="max-width:92vw;max-height:92vh;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.5)">
</div>


<div id="loginGate">
  <div id="loginCard">
    <h2>後台登入</h2>
    <div class="muted">請輸入密碼以查看訂單</div>
    <div class="hint">請使用管理員 Google 帳號登入</div>
    <div class="row">
      <button class="btn gold" id="loginGo">登入管理員</button>
      <button class="btn" id="loginCancel">取消</button>
    </div>
  </div>
</div>
</body>
</html>	
