<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="robots" content="noindex,nofollow">
  <title>unalomecodes | Staff Manual</title>
  <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16.png">
  <link rel="stylesheet" href="/admin/admin-ui.css">
  <link rel="stylesheet" href="/css/admin-staff-manual.inline-1.css">
  <script src="/js/admin-guard.js" defer></script>
  <script src="/js/admin-shell.js" defer></script>
</head>
<body class="admin-view staff-manual-view">
  <div class="wrap" data-admin-page="staff-manual">
    <div class="page">
      <div class="page-head">
        <div class="page-title">
          <h1 data-i18n="manual_title">工作人員操作手冊 / Staff Manual</h1>
          <div class="page-sub">Phone consult operation guide for staff · Updated 2026-01-27</div>
        </div>
      </div>
      <div id="staffManualGuard" class="card" style="display:none;">無權限</div>
      <div id="staffManualContent" class="page-body">
        <div class="manual-layout">
          <aside class="manual-toc card">
            <div class="toc-head">
              <div class="toc-title">目錄</div>
              <div class="toc-actions">
                <a class="btn primary" href="/admin/slots">前往時段管理</a>
                <a class="btn" href="/admin/dashboard" target="_blank" rel="noopener">Dashboard ↗</a>
              </div>
            </div>
            <div id="manualToc" class="toc-list"></div>
            <div class="toc-foot muted">
              適用角色：Owner / Booking
              <span class="dot">•</span>
              主要路徑：/admin/slots
            </div>
          </aside>

          <main class="manual-main">
            <section class="panel" id="intro">
              <h2>0. 你要做到的事（One-screen summary）</h2>
              <div class="manual-grid">
                <div class="mini-card">
                  <div class="mini-title">每天開始（10 分鐘內）</div>
                  <ol class="mini-list">
                    <li>進入 <a href="/admin/slots">時段管理</a>，確認 <span class="kbd">預約模式</span>。</li>
                    <li>選取今日/近期時段 → <span class="kbd">開放選取時段</span> 或 <span class="kbd">一鍵上架 + 開放</span>。</li>
                    <li>確認 <span class="kbd">已開放時段</span> 列表有出現。</li>
                    <li>在 <span class="kbd">電話算命預約</span> 裡把階段推進（Booking confirmed / Done）。</li>
                  </ol>
                </div>
                <div class="mini-card">
                  <div class="mini-title">遇到突發狀況（先保護客人）</div>
                  <ul class="mini-list">
                    <li>想暫停預約：用 <span class="kbd">立即關閉預約</span>（限時模式）。</li>
                    <li>不要亂用 <span class="kbd danger">解除已預約時段</span>（會清空預約）。</li>
                    <li>改期：一律請客人透過客服 LINE 聯繫。</li>
                  </ul>
                </div>
              </div>
              <div class="callout warn">
                <div class="callout-title">重要觀念</div>
                <div class="callout-body">
                  後台所有按鈕都會直接影響客人的可預約時段、通知信與訂單狀態。看到任何確認視窗，請先再次核對日期、時段與 serviceId。
                </div>
              </div>
            </section>

            <section class="panel" id="roles">
              <h2>1. 角色與權限（Role / Permission）</h2>
              <div class="manual-grid">
                <div class="mini-card">
                  <div class="mini-title">Owner</div>
                  <div class="muted">全權限：可設定/檢視所有資料、調整營運設定。</div>
                </div>
                <div class="mini-card">
                  <div class="mini-title">Booking</div>
                  <div class="muted">可管理時段與電話諮詢流程；改期/取消一律轉客服 LINE。</div>
                </div>
                <div class="mini-card">
                  <div class="mini-title">Fulfillment</div>
                  <div class="muted">不可操作電話諮詢時段與改期。</div>
                </div>
              </div>
            </section>

            <section class="panel" id="concepts">
              <h2>2. 系統概念（先懂這些就不會做錯）</h2>
              <div class="manual-grid">
                <div class="mini-card">
                  <div class="mini-title">serviceId 是你的「服務類別」</div>
                  <ul class="mini-list">
                    <li>沒有 serviceId：你看到的時段可能是空的。</li>
                    <li>後台可能會自動帶入 serviceId（唯讀）。</li>
                    <li>如果沒有自動帶入：請向 Owner 確認 phone consult 服務設定。</li>
                  </ul>
                </div>
                <div class="mini-card">
                  <div class="mini-title">四種時段狀態（跟前台體驗直接相關）</div>
                  <ul class="mini-list">
                    <li>🟢 可預約：客人看得到且可點。</li>
                    <li>🟡 保留中：有人正在結帳/填資料，短時間內他人不可搶。</li>
                    <li>🔴 已預約：已綁定訂單。</li>
                    <li>⚪ 未開放：後台存在但前台不可預約。</li>
                  </ul>
                </div>
                <div class="mini-card">
                  <div class="mini-title">時區（Schedule 尤其容易錯）</div>
                  <ul class="mini-list">
                    <li>排程視窗會提示：泰國時間（Asia/Bangkok），台灣時間 +1。</li>
                    <li>任何排程前，先跟團隊確認「以哪個地區時間對外公告」。</li>
                  </ul>
                </div>
              </div>
            </section>

            <section class="panel" id="daily-sop">
              <h2>3. 每日 SOP（Booking staff 日常流程）</h2>
              <div class="sop-card">
                <div class="sop-title">A) 開放今天/明天的預約時段</div>
                <ol class="sop-steps">
                  <li>進入 <a href="/admin/slots">/admin/slots</a>。</li>
                  <li>確認上方的 <span class="kbd">serviceId</span> 是否正確。</li>
                  <li>用左右箭頭切到目標日期，勾選要開放的時段。</li>
                  <li>使用其中一種方式：
                    <div class="sop-variants">
                      <div class="variant">
                        <div class="variant-title"><span class="kbd">開放選取時段</span>（一般）</div>
                        <div class="muted">只做「上架」，不強制切換模式。</div>
                      </div>
                      <div class="variant">
                        <div class="variant-title"><span class="kbd">一鍵上架 + 開放</span>（限時模式）</div>
                        <div class="muted">上架 + 立即開放預約視窗（會用「開放時長」）。</div>
                      </div>
                    </div>
                  </li>
                  <li>確認 <span class="kbd">已開放時段（含日期）</span> 有出現新增的時段。</li>
                </ol>
              </div>

              <div class="sop-card">
                <div class="sop-title">B) 限時模式（Windowed）怎麼用</div>
                <ol class="sop-steps">
                  <li>把 <span class="kbd">預約模式</span> 切到 <span class="kbd">限時模式（手動開放）</span>。</li>
                  <li>設定 <span class="kbd">開放時長（分鐘）</span>（例如 60）。</li>
                  <li>兩種開放方式擇一：
                    <div class="sop-variants">
                      <div class="variant">
                        <div class="variant-title"><span class="kbd">一鍵上架 + 開放</span></div>
                        <div class="muted">立即生效，適合「今天要開放」或臨時加開。</div>
                      </div>
                      <div class="variant">
                        <div class="variant-title"><span class="kbd">排程上架 + 開放</span></div>
                        <div class="muted">先排程，時間到才開放；可用 <span class="kbd">查看已排程時段</span> 檢查。</div>
                      </div>
                    </div>
                  </li>
                  <li>要提前關掉：按 <span class="kbd">立即關閉預約</span>。</li>
                  <li>要取消排程：按 <span class="kbd">取消排程</span>。</li>
                </ol>
                <div class="callout ok">
                  <div class="callout-title">適用情境</div>
                  <div class="callout-body">限時模式適合「每週固定開放時間」、「造成搶位時的公平性」或「配合直播引流」。</div>
                </div>
              </div>
            </section>

            <section class="panel" id="consult-queue">
              <h2>4. 電話算命預約（Consult Queue）</h2>
              <div class="manual-grid">
                <div class="mini-card">
                  <div class="mini-title">你要做的只有兩件事</div>
                  <ol class="mini-list">
                    <li>付款確認後 → 按 <span class="kbd">已完成預約</span>（appointment_confirmed）。</li>
                    <li>通話結束/結案 → 按 <span class="kbd">訂單完成</span>（done）。</li>
                  </ol>
                </div>
                <div class="mini-card">
                  <div class="mini-title">階段定義（系統文字）</div>
                  <ul class="mini-list">
                    <li>payment_pending：訂單成立待確認付款</li>
                    <li>payment_confirmed：已確認付款，預約中（此時可按「已完成預約」）</li>
                    <li>appointment_confirmed：已完成預約（此時可按「訂單完成」）</li>
                    <li>done：已完成訂單</li>
                  </ul>
                </div>
              </div>
              <details class="faq" id="consult-faq">
                <summary>常見卡住點：按鈕為什麼是灰色？</summary>
                <div class="faq-body">
                  <div class="muted">系統用階段鎖住流程：</div>
                  <ul class="mini-list">
                    <li>只有在 payment_confirmed 才能按「已完成預約」。</li>
                    <li>只有在 appointment_confirmed 才能按「訂單完成」。</li>
                    <li>如果不確定付款是否確認：先回到服務訂單頁或詢問 Owner。</li>
                  </ul>
                </div>
              </details>
            </section>

            <section class="panel" id="danger-zone">
              <h2>5. 危險區（這些動作會改掉客人預約）</h2>
              <div class="callout danger">
                <div class="callout-title">解除已預約時段（Danger）</div>
                <div class="callout-body">
                  <div>按下 <span class="kbd danger">解除已預約時段</span> 會把該時段的「已預約」清空並重新開放。</div>
                  <div class="muted">只在「確定該客人無法來、且你已經通知客人/團隊」時使用。</div>
                </div>
              </div>
              <div class="manual-grid">
                <div class="mini-card">
                  <div class="mini-title">禁止事項（Hard rules）</div>
                  <ul class="mini-list danger-list">
                    <li>不可私下改 slot（改期一律走客服 LINE）。</li>
                    <li>不可代客人建立訂單。</li>
                    <li>不可刪除歷史訂單。</li>
                    <li>不可修改付款資料。</li>
                  </ul>
                </div>
                <div class="mini-card">
                  <div class="mini-title">你可以做的安全動作</div>
                  <ul class="mini-list">
                    <li>用「取消選取時段」把未預約的時段下架。</li>
                    <li>用「立即關閉預約」暫停搶位（限時模式）。</li>
                    <li>在「已開放時段」按重新整理核對清單。</li>
                  </ul>
                </div>
              </div>
            </section>

            <section class="panel" id="reschedule">
              <h2>6. 改期與異動（只走客服 LINE）</h2>
              <div class="callout warn">
                <div class="callout-title">原則</div>
                <div class="callout-body">
                  改期、取消、特殊例外（例如：超過時間限制）一律請客人透過客服 LINE 聯繫，由客服統一對外說明與安排。Booking 人員不要在後台私自更動預約時段。
                </div>
              </div>
              <div class="manual-grid">
                <div class="mini-card">
                  <div class="mini-title">你要做的事</div>
                  <ul class="mini-list">
                    <li>請客人提供：訂單編號、原時段、想改的日期區間。</li>
                    <li>把資訊回報到客服 LINE／工作群（依你們內部流程）。</li>
                    <li>需要臨時關閉預約：用「立即關閉預約」（限時模式）。</li>
                  </ul>
                </div>
                <div class="mini-card">
                  <div class="mini-title">你不要做的事</div>
                  <ul class="mini-list danger-list">
                    <li>不要用「解除已預約時段」來當改期手段。</li>
                    <li>不要在未確認情況下承諾客人「一定可以改」。</li>
                    <li>不要用後台幫客人手動建立/代購訂單。</li>
                  </ul>
                </div>
              </div>
            </section>

            <section class="panel" id="troubleshooting">
              <h2>7. 疑難排解（症狀 → 原因 → 解法）</h2>
              <div class="table-wrap">
                <table class="manual-table">
                  <thead>
                    <tr>
                      <th>症狀</th>
                      <th>可能原因</th>
                      <th>建議處理</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>看不到任何時段 / 無法操作</td>
                      <td>serviceId 不正確、權限不足、或 service 尚未設定</td>
                      <td>先確認你是 Booking/Owner → 再確認 serviceId 是否自動帶入/正確 → 仍不行請找 Owner 檢查設定</td>
                    </tr>
                    <tr>
                      <td>客人說「剛剛看到」但現在按不到</td>
                      <td>🟡 保留中（他人正在結帳）或限時視窗已關閉</td>
                      <td>請客人 30-120 秒後重試；若為限時模式，確認是否仍在開放時間</td>
                    </tr>
                    <tr>
                      <td>客人要改期 / 取消</td>
                      <td>需要統一對外口徑與安排</td>
                      <td>請客人透過客服 LINE 聯繫；Booking 人員不要在後台私自更動</td>
                    </tr>
                    <tr>
                      <td>客人要求「破例」或情緒升級</td>
                      <td>超出 Booking 可處理範圍</td>
                      <td>立即轉客服 LINE／Owner；先停止任何後台動作，避免造成更多誤會</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </section>
          </main>
        </div>
      </div>
    </div>
  </div>
  <script src="/js/staff-manual.inline.js"></script>
</body>
</html>
