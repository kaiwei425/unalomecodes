<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="æ³°åœ‹ç¾é£Ÿåœ°åœ–èˆ‡æ¨è–¦æ¸…å–®ï¼Œå¿«é€Ÿæœå°‹èˆ‡æ”¶è—å–œæ„›çš„æ³°åœ‹é¤å»³èˆ‡å°åƒã€‚">
  <link rel="canonical" href="https://shop.unalomecodes.com/food-map">
  <title>æ³°åœ‹ç¾é£Ÿåœ°åœ–ï½œunalomecodes</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Sora:wght@400;600;700;800&display=swap');
    :root{
      --bg:#f7f8fb;
      --card:#ffffff;
      --text:#0f172a;
      --muted:#64748b;
      --accent:#ff5a3c;
      --accent-2:#ff8a00;
      --line:#e2e8f0;
      --pill:#fff3ee;
      --shadow:0 18px 40px rgba(15,23,42,.12);
    }
    *{box-sizing:border-box;}
    body{margin:0;background:var(--bg);font-family:'Sora','Segoe UI',system-ui,-apple-system,sans-serif;color:var(--text);line-height:1.6;}
    header{position:sticky;top:0;z-index:20;background:#fff;border-bottom:1px solid var(--line);box-shadow:0 12px 26px rgba(15,23,42,.08);}
    .wrap{max-width:1120px;margin:0 auto;padding:18px;}
    .topbar{display:flex;align-items:center;gap:12px;flex-wrap:wrap;}
    .brand{display:flex;align-items:center;gap:12px;}
    .brand img{width:42px;height:42px;border-radius:12px;box-shadow:0 0 0 3px rgba(255,90,60,.16);}
    .brand-title{font-size:13px;font-weight:700;color:var(--muted);letter-spacing:.2px;}
    .brand-sub{font-size:12px;color:var(--muted);}
    h1{margin:0;font-size:28px;font-weight:800;}
    .sub{margin:6px 0 0;font-size:14px;color:var(--muted);}
    .top-actions{margin-left:auto;display:flex;gap:8px;flex-wrap:wrap;}
    .hero{display:grid;grid-template-columns:1.2fr .8fr;gap:16px;margin-top:14px;align-items:stretch;}
    .hero-panel{background:linear-gradient(135deg, rgba(255,90,60,.14), rgba(255,138,0,.1));border:1px solid rgba(255,90,60,.25);border-radius:18px;padding:14px;display:grid;gap:10px;}
    .searchbox{display:flex;align-items:center;gap:8px;background:#fff;border:1px solid var(--line);border-radius:14px;padding:10px 12px;box-shadow:0 10px 18px rgba(15,23,42,.08);}
    .searchbox input{border:none;outline:none;font-size:14px;width:100%;font-family:inherit;background:transparent;}
    .search-icon{font-size:16px;color:var(--accent);}
    .filter-row{display:flex;gap:8px;flex-wrap:wrap;}
    .filter-select{appearance:none;background:#fff;border:1px solid var(--line);border-radius:999px;padding:8px 12px;font-size:13px;font-family:inherit;color:var(--text);box-shadow:0 6px 14px rgba(15,23,42,.06);}
    .cards{display:grid;gap:14px;margin:18px 0 32px;}
    .card{display:grid;grid-template-columns:190px 1fr;gap:16px;background:var(--card);border:1px solid var(--line);border-radius:18px;padding:12px;box-shadow:var(--shadow);}
    .cover{position:relative;border-radius:14px;overflow:hidden;background:#0f172a;height:140px;}
    .cover img{width:100%;height:100%;object-fit:cover;}
    .card-body{display:grid;gap:8px;align-content:start;}
    .card-head{display:flex;align-items:flex-start;justify-content:space-between;gap:10px;}
    .card-title{font-size:18px;font-weight:800;margin:0;}
    .card-sub{font-size:12px;color:var(--muted);}
    .card-addr{font-size:13px;color:#475569;}
    .card-tags{display:flex;flex-wrap:wrap;gap:6px;}
    .tag{display:inline-flex;align-items:center;gap:4px;padding:4px 8px;border-radius:999px;background:var(--pill);color:#c2410c;font-weight:700;border:1px solid rgba(255,90,60,.25);font-size:12px;}
    .badge-hot{display:inline-flex;align-items:center;padding:2px 8px;border-radius:999px;background:rgba(255,90,60,.12);color:var(--accent);font-weight:700;font-size:11px;}
    .card-actions{display:flex;flex-wrap:wrap;gap:8px;}
    .btn{flex:1 1 140px;display:flex;align-items:center;justify-content:center;gap:6px;padding:10px 12px;border-radius:12px;border:1px solid var(--line);background:#fff;font-weight:700;cursor:pointer;text-decoration:none;color:var(--text);font-family:inherit;transition:transform .15s ease, box-shadow .15s ease;}
    .btn:hover{transform:translateY(-1px);box-shadow:0 10px 18px rgba(15,23,42,.1);}
    .btn.primary{background:linear-gradient(135deg,var(--accent),var(--accent-2));color:#fff;border-color:transparent;}
    .btn.ghost{background:#fff3ee;border-color:#ffd4c4;color:#d9480f;}
    .btn.pill{border-radius:999px;padding:8px 14px;font-size:12px;flex:0 0 auto;}
    .fav-btn{border:1px solid var(--line);background:#fff;border-radius:999px;width:34px;height:34px;display:grid;place-items:center;cursor:pointer;box-shadow:0 6px 12px rgba(15,23,42,.12);}
    .pill-inline{display:inline-flex;align-items:center;gap:6px;padding:4px 10px;border-radius:10px;background:#f8fafc;border:1px solid var(--line);font-size:12px;}
    .tag-row{display:flex;flex-wrap:wrap;gap:6px;font-size:12px;}
    .admin-panel{margin-top:12px;padding-top:12px;border-top:1px dashed var(--line);display:grid;gap:10px;}
    .admin-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:8px;}
    .admin-field{display:grid;gap:6px;font-size:12px;color:var(--muted);}
    .admin-grid label{display:grid;gap:6px;font-size:12px;color:var(--muted);}
    .admin-input{padding:8px 10px;border-radius:10px;border:1px solid var(--line);background:#fff;font-size:12px;font-family:inherit;}
    .admin-textarea{min-height:70px;padding:8px 10px;border-radius:10px;border:1px solid var(--line);background:#fff;font-size:12px;font-family:inherit;resize:vertical;}
    .admin-actions{display:flex;gap:8px;flex-wrap:wrap;}
    .admin-hint{font-size:11px;color:#64748b;}
    .empty-state{background:#fff;border:1px dashed var(--line);border-radius:16px;padding:24px;text-align:center;color:var(--muted);box-shadow:var(--shadow);}
    .empty-state h3{margin:0 0 6px;font-size:18px;color:var(--text);}
    .empty-state p{margin:0 0 14px;font-size:13px;}
    @media(max-width:900px){
      .hero{grid-template-columns:1fr;}
    }
    @media(max-width:720px){
      .card{grid-template-columns:1fr;}
      .cover{height:180px;}
    }
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <div class="topbar">
        <div class="brand">
          <img src="https://i.ibb.co/7mtppQQ/logo.jpg" alt="">
          <div>
            <div class="brand-title">unalomecodes</div>
            <div class="brand-sub">Thailand Food Map</div>
          </div>
        </div>
        <div class="top-actions">
          <button class="btn ghost pill" id="btnBack">â† è¿”å›ä¸Šä¸€é </button>
          <button class="btn ghost pill" id="btnFav">æ”¶è—æ¸…å–®</button>
          <button class="btn ghost pill" id="btnAdmin">ç®¡ç†ç·¨è¼¯</button>
        </div>
      </div>
      <div class="hero">
        <div>
          <h1>æ³°åœ‹ç¾é£Ÿåœ°åœ–</h1>
          <div class="sub">ç²¾é¸ IG å½±éŸ³ï¼‹åœ°åœ–å°èˆªï¼Œå¿«é€Ÿæ‰¾åˆ°ä½ è¦çš„é¤å»³</div>
        </div>
        <div class="hero-panel">
          <div class="searchbox">
            <span class="search-icon">ğŸ”</span>
            <input type="text" id="kw" placeholder="æœå°‹åº—å / é—œéµå­—">
          </div>
          <div class="filter-row">
            <select id="fCat" class="filter-select">
              <option value="">å…¨éƒ¨åˆ†é¡</option>
            </select>
            <select id="fArea" class="filter-select">
              <option value="">å…¨éƒ¨åœ°å€</option>
            </select>
            <select id="fPrice" class="filter-select">
              <option value="">å…¨éƒ¨åƒ¹ä½</option>
              <option value="$">$ï¼ˆâ‰¤200ï¼‰</option>
              <option value="$$">$$ï¼ˆ200â€“500ï¼‰</option>
              <option value="$$$">$$$ï¼ˆ500+ï¼‰</option>
            </select>
          </div>
        </div>
      </div>
    </div>
  </header>

  <main class="wrap">
    <div class="cards" id="cards"></div>
  </main>

  <dialog id="foodModal" style="border:none;border-radius:16px;padding:0;max-width:720px;width:95%;box-shadow:0 20px 40px rgba(0,0,0,.25);">
    <div id="foodModalBody" style="padding:0;overflow:hidden;border-radius:16px;"></div>
  </dialog>

<script>
const BASE_DATA = [
  {
    id:'bkk-cafe-004',
    name:'Cataleya Estate',
    category:'é¤é…’é¤¨ / å…¨æ—¥é¤',
    area:'Bang Chak',
    price:'$$',
    address:'88 Soi Punnawitthi 33 alley, Bang Chak, Phra Khanong, Bangkok 10260',
    maps:'https://maps.google.com/?q=Cataleya%20Estate%20Bang%20Chak',
    cover:'https://scontent.cdninstagram.com/v/t51.82787-15/529214355_17896743888284647_8670366285479077233_n.jpg?stp=cmp1_dst-jpg_e35_s640x640_tt6&_nc_cat=107&ccb=7-5&_nc_sid=18de74&efg=eyJlZmdfdGFnIjoiQ0xJUFMuYmVzdF9pbWFnZV91cmxnZW4uQzMifQ%3D%3D&_nc_ohc=z3I7zGIDMckQ7kNvwElS2fv&_nc_oc=AdkG7rKaynxD5FOZj4obts_2vuFX0NIqfC10MHp9eOFELlrDMabKhljZou9rxFcrSwEPkevndU-ye3T_MW4t3cEI&_nc_zt=23&_nc_ht=scontent.cdninstagram.com&_nc_gid=-U5MEdl-XnIF04c2PIMf-g&oh=00_AfmLumi3uVLIiKjS0tO7vnLZ96V8ErB4EsleAH_q1MZm5g&oe=6958B016',
    ig:'https://www.instagram.com/p/DNHrSE9zmZ4/',
    intro:'åœ¨æ›¼è°·è®“ä½ ä¸€é€²å»å°±ä¸æƒ³å‡ºä¾†çš„åœ°æ–¹â€¦.\né€™é–“Cataleya Estateæˆ‘å¾ˆæ„›\nä¸€èµ°é€²å»å°±é©šè±”åˆ°äº†\næ•´å€‹ç©ºé–“æ²’æœ‰ä¸€å€‹åœ°æ–¹ä¸é©åˆæ‹ç…§\nç©ºé–“è¦åŠƒè·Ÿç‡ˆå…‰æ­é…è¶…ç´šèˆ’é©\nä»–å€‘çš„é¤é»å¾æ—©é¤ã€æ—©åˆé¤ã€æ™šé¤éƒ½æœ‰\né£²å“ä¹Ÿå¾å’–å•¡ã€ç„¡é…’ç²¾ã€cocktail æ‡‰æœ‰ç›¡æœ‰\nç„¶å¾Œé¤é»éƒ½å¾ˆå¥½åƒï¼\nè¶…ç´šæ¨è–¦ä¾†é€™è£¡ï½ï½\n\nCataleya Estate is a Bangkok gem youâ€™ll never want to leave. Itâ€™s stunning the moment you walk in, with cozy lighting, perfect layout, and photo spots everywhere. Theyâ€™ve got everything from breakfast to dinner, plus coffee, mocktails, and cocktails. Best part is the foodâ€™s amazing. Totally a must-visit.\n\nğŸ Cataleya Estate\nğŸ“88 Soi Punnawitthi 33 alley, Bang Chak, Phra Khanong, Bangkok 10260\n\n#bangkok #thailand #à¸£à¹‰à¸²à¸™à¸­à¸²à¸«à¸²à¸£ #bkkrestaurant #food #streetphotography #cafe #CataleyaEstate #brunch #cocktail'
  },
  {
    id:'bkk-italian-001',
    name:'Franca | Modern Italian and Fine Steaks',
    category:'ç¾©å¼æ–™ç† / ç‰›æ’',
    area:'Asok',
    price:'$$$',
    address:'31 Sukhumvit 10 Alley, Khlong Toei, Bangkok 10110',
    maps:'https://maps.google.com/?q=Franca%20Modern%20Italian%20and%20Fine%20Steaks%20Bangkok',
    cover:'https://scontent.cdninstagram.com/v/t51.71878-15/587866236_830172242963132_3169791276975223798_n.jpg?stp=cmp1_dst-jpg_e35_s640x640_tt6&_nc_cat=100&ccb=7-5&_nc_sid=18de74&efg=eyJlZmdfdGFnIjoiQ0xJUFMuYmVzdF9pbWFnZV91cmxnZW4uQzMifQ%3D%3D&_nc_ohc=-DC_JpC7w74Q7kNvwHvk82J&_nc_oc=AdnqIeZHAlQfU8p4_CIIbLlegXYAmH3yS4n7b5KYLSif_GPIpfMohMjP4dW7MG-T1VcMVeVTUtOsnygl2aO3G4FP&_nc_zt=23&_nc_ht=scontent.cdninstagram.com&_nc_gid=s-vtszIMx_Q3O1cbnmEQeg&oh=00_AfmftIdBSMi6o3P6I67rLDDnuGo9fQAsMj6vgXicg9eIHA&oe=6958A25E',
    ig:'https://www.instagram.com/p/DRmHPLdk6W_/',
    intro:'æ›¼è°·é€™é–“é¤å»³å¯ä»¥è¨­è¨ˆè‡ªå·±çš„é£²å“\nåº—å…§ä½ˆç½®çš„è¶…ç´šæµªæ¼« ç‡ˆå…‰ä¹Ÿå¾ˆç¾\nä¸€èµ°é€²å»å°±å…ˆè¢«å¤–é¢çš„èŠ±åœ’é©šè‰·äº†\næ•´å€‹è¶…é©åˆæ‹ç…§çš„\nç„¶å¾Œä¸‹åˆæˆ–æ™šä¸Šä¾†æœ‰ä¸ä¸€æ¨£çš„æ„Ÿè¦ºè·Ÿæ°›åœ\næˆ‘è¦ºå¾—æ˜¯ç´„æœƒè·Ÿæ…¶ç”Ÿçš„é¦–é¸\nä»–å€‘çš„èœè‰²éƒ½æ˜¯æ°´æº–ä¹‹ä¸Š\né¾è¦ç¾©å¤§åˆ©éºµè·Ÿæ¾éœ²æµ·é®®ç‡‰é£¯æˆ‘è¶…æ„›\nä¸ç®¡æ˜¯éºµæ¢é‚„æ˜¯ç±³å¿ƒ éƒ½å¸æ»¿äº†æµ·é®®çš„ç²¾è¯\nè¶…ç´šå¥½åƒï¼\næœ€æœ‰ç‰¹è‰²çš„æ˜¯ä»–å€‘çš„é£²å“\nå¯ä»¥è‡ªå·±é¸åœ–æ¡ˆè·Ÿå‘ˆç¾çš„æ–‡å­—\nç„¶å¾Œå°±æœƒå¾—åˆ°è‡ªå·±çš„ä¸€æ¯å°ˆå±¬é£²å“\nä½ç½®ä¹Ÿè¶…ç´šå¸‚ä¸­å¿ƒ\nå°±åœ¨Asokæ·é‹ç«™é™„è¿‘\n\nğŸ Franca | Modern Italian and Fine Steaks\nğŸ“31 Sukhumvit 10 Alley, Khlong Toei, Bangkok 10110\n\n#bangkok #thailand #à¸£à¹‰à¸²à¸™à¸­à¸²à¸«à¸²à¸£ #bkkrestaurant #food #streetphotography #food #cafe #italian #steak #dining #christmas'
  },
  {
    id:'bkk-coffee-002',
    name:'à¸à¸šà¸«à¸™à¹‰à¸² specialty coffee & roastery',
    category:'å’–å•¡å»³',
    area:'Silom',
    price:'$',
    address:'12, 13 Convent Rd, Si Lom, Bang Rak, Bangkok 10500',
    maps:'https://maps.google.com/?q=%E0%B8%9E%E0%B8%9A%E0%B8%AB%E0%B8%99%E0%B9%89%E0%B8%B2%20specialty%20coffee%20roastery',
    cover:'https://scontent.cdninstagram.com/v/t51.82787-15/587466298_17908781151284647_6081286617430714832_n.jpg?stp=cmp1_dst-jpg_e35_s640x640_tt6&_nc_cat=102&ccb=7-5&_nc_sid=18de74&efg=eyJlZmdfdGFnIjoiQ0xJUFMuYmVzdF9pbWFnZV91cmxnZW4uQzMifQ%3D%3D&_nc_ohc=9yLSf43ZEHAQ7kNvwELUISt&_nc_oc=Admvb_2IWshW0gJappfQqQ2hYv5zjxFLvsBmZpXijQ-fRMUQD378JO8VM8UJNvvoZXtQz3e_znn5hj5qoqZwOAei&_nc_zt=23&_nc_ht=scontent.cdninstagram.com&_nc_gid=yb2i3YFxJ4sPzuTOqMQoaA&oh=00_Aflm_lzoLtlGawuTACfcvVneT-4570BOiTY5RRGBr1AY1Q&oe=6958A736',
    ig:'https://www.instagram.com/p/DRWfPoPEymm/',
    intro:'éš±è—åœ¨Silom çš„å°å··æ·±è™•\nçœŸçš„å¾ˆé›£æ‰¾\nä¸€è·¯ç©¿éåœ¨åœ°äººä½å®¶\nçœ‹åˆ°å°å°æ‹›ç‰Œæ‰ç¢ºå®šèµ°å°\nå¤–è§€çœ‹èµ·ä¾†ä¸èµ·çœ¼\nè£¡é¢å»æ˜¯å……æ»¿æ•…äº‹çš„è€å®…\nè€ä»¶æ“ºè¨­è¶…æœ‰å‘³é“\nåº—è£¡æœ‰è‡ªå·±çš„çƒ˜è±†æ©Ÿ\nååœ¨è£¡é¢çƒ˜è±†é¦™ä¸€ç›´é£„éä¾†\nå’–å•¡ä¾¿å®œä½†å“è³ªè¶…å¥½\nå†°ç¾å¼ä¹Ÿåªè¦å…­åæ³°éŠ–\nè±†å­é¸æ“‡è¶…ç´šå¤š\né»å®Œå’–å•¡å»éš”å£æˆ¿å–\næ”¾è‘—å…­é›¶å¹´ä»£å¾©å¤é›»å½±\näºŒæ¨“å…‰ç·šè¶…ç¾ éš¨æ‰‹éƒ½åƒé›»å½±ç•«é¢\nå¤–é¢é‚„æœ‰å°åº­é™¢è·Ÿæ»¿æ»¿æ¤æ ½\næœ‰èƒ–æŸ¯åŸºè·Ÿæ©˜è²“åé®\nåœ¨æ›¼è°·22åº¦çš„å­£ç¯€è£¡\né€™è£¡ç„¡ç–‘æ˜¯æœ€ç¾æœ€æµªæ¼«çš„åœ°æ–¹\n\nğŸ à¸à¸šà¸«à¸™à¹‰à¸² specialty coffee & roastery\nğŸ“12, 13 Convent Rd, Si Lom, Bang Rak, Bangkok 10500'
  },
  {
    id:'bkk-brunch-003',
    name:'COUCOU All Day Dining | The Flavorhood',
    category:'å…¨æ—¥æ—©åˆé¤',
    area:'Lat Phrao',
    price:'$$',
    address:'187 Pradit Manutham Rd, Khwaeng Lat Phrao, Lat Phrao, Bangkok 10230',
    maps:'https://maps.google.com/?q=COUCOU%20All%20Day%20Dining%20The%20Flavorhood%20Bangkok',
    cover:'https://scontent.cdninstagram.com/v/t51.71878-15/582542284_3756314964677374_3651551036777325519_n.jpg?stp=cmp1_dst-jpg_e35_s640x640_tt6&_nc_cat=102&ccb=7-5&_nc_sid=18de74&efg=eyJlZmdfdGFnIjoiQ0xJUFMuYmVzdF9pbWFnZV91cmxnZW4uQzMifQ%3D%3D&_nc_ohc=JxDD0h6ddkkQ7kNvwGsbeZf&_nc_oc=AdmZvXJwJPBkCwZaty3uC9iuWWSCna63GpYO0vgyVoDcKNamB6K_uXwQGNuperZy1Vjuzh6ZbmQerfkuBkTom67o&_nc_zt=23&_nc_ht=scontent.cdninstagram.com&_nc_gid=c9XXTOtBPyzEoZmKaVj0TA&oh=00_Afkv3JcYXjtpahFsmTG2EuO31nzpNTNDRbK2mzHhe7AKEQ&oe=69588F8F',
    ig:'https://www.instagram.com/p/DRD-_Z4EzK3/',
    intro:'æ›¼è°·é–‹å¹•ç´…åˆ°ç¾åœ¨çš„å…¨æ—¥æ—©åˆé¤é¤å»³\né€™é–“ç®—æ˜¯æˆ‘çš„ç§è—åå–®\nä¸éå°±æ˜¯é›¢å¸‚å€æœ‰é»å°è·é›¢\næ•´é–“åº—è£æ½¢è·Ÿæ°›åœéƒ½è¶…ç´šç¾\nç‡ˆå…‰è¨­è¨ˆå¥½åˆ°éš¨ä¾¿æ‹éƒ½åƒåœ¨é›œèªŒè£¡\nä¸ç®¡æ˜¯ä¾†åƒæ—©åˆé¤é‚„æ˜¯æ™šé¤éƒ½è¶…é©åˆ\nå¾ç™½å¤©ååˆ°æ™šä¸Šå®Œå…¨æ²’å•é¡Œ\né¤é»ä¹Ÿéƒ½å¾ˆæœ‰æ°´æº–\næˆ‘æ»¿æ¨è–¦ä»–å€‘çš„ç‡‰é£¯\næ™šä¸Šé‚„æœ‰ç¾å ´DJ\næ°£æ°›ç›´æ¥æ‹‰åˆ°æ»¿åˆ†\næ•´é–“åº—çš„æ¦‚å¿µæ˜¯\nè®“æ¯ä¸€å€‹ä¾†çš„äººéƒ½èƒ½æ„Ÿå—åˆ°è¢«å¥½å¥½æ¥å¾…\næƒ³è®“ä½ è¦ºå¾—åƒå›å®¶ä¸€æ¨£æº«æš–\nå¾ˆé©åˆèšæœƒç”Ÿæ—¥ã€ç´„æœƒæˆ–è‡ªå·±ä¾†æ”¾ç©º\næ‡‚åƒæ‡‚æ‹çš„äººä¸€å®šæœƒå¾ˆæ„›\n\nğŸ COUCOU All Day Dining | The Flavorhood\nThe Flavorhood Project Bangkok\nğŸ“187 Pradit Manutham Rd, Khwaeng Lat Phrao, Lat Phrao, Bangkok 10230\nâ°8am-10pm'
  },
  {
    id:'bkk-jp-002',
    name:'Tonkatsu AOKI @ICONSIAM',
    category:'æ—¥å¼æ–™ç† / ç‚¸è±¬æ’',
    area:'ICONSIAM',
    price:'$$',
    address:'ICONSIAM 4F, Bangkok',
    maps:'https://maps.google.com/?q=Tonkatsu%20AOKI%20ICONSIAM',
    cover:'https://scontent.cdninstagram.com/v/t51.82787-15/581672772_17907696582284647_2778053506904116756_n.jpg?stp=cmp1_dst-jpg_e35_s640x640_tt6&_nc_cat=105&ccb=7-5&_nc_sid=18de74&efg=eyJlZmdfdGFnIjoiQ0xJUFMuYmVzdF9pbWFnZV91cmxnZW4uQzMifQ%3D%3D&_nc_ohc=3JS37LEAolcQ7kNvwFbPdPf&_nc_oc=AdkwBFBjBnV_iUe0c_qQjrP6d71udtuoRENHxrYNsWgJq3J28wkHI57DsQLXNxuzhI2KcrA9qge402dVs94qH8N6&_nc_zt=23&_nc_ht=scontent.cdninstagram.com&_nc_gid=aCta5WA_ID5-o2YWoxncuw&oh=00_AfnWC_FKJpeGVOe_pOZISfmJSpnKm0-OhboywE_QJLkpcg&oe=6958924E',
    ig:'https://www.instagram.com/p/DQ8Sk_oE5f7/',
    intro:'Tonkatsu AOKI ä¾†è‡ªæ—¥æœ¬æ±äº¬çš„ç‚¸è±¬æ’ååº—\nä»¥ã€Œåªåšæœ€å®Œç¾çš„è±¬æ’ã€ç‚ºç²¾ç¥\nåš´é¸ä¸ƒç¨®è±¬è‚‰éƒ¨ä½ï¼Œä½¿ç”¨ Senmonten å°ˆé–€åº—ç´šç‚¸è£½æŠ€è¡“\nåœ¨æ—¥æœ¬æ˜¯è¶…äººæ°£æ’éšŠåº—ä¹‹ä¸€\né€™å€‹æœˆä»–å€‘åœ¨ ICONSIAM é–‹æ–°åˆ†åº—\næ•´å€‹å»šæˆ¿æ˜¯é–‹æ”¾å¼çš„\nå¯ä»¥çœ‹åˆ°å¸«å‚…ç¾å ´ç‚¸è±¬æ’\né‚£å€‹é…¥ç‚¸è²çœŸçš„è¶…ç™‚ç™’\næ­é…æ—¥æœ¬åŒ—æµ·é“ç‰¹Aé¦™ç±³\nè±¬æ’å’¬ä¸‹å»é‚„æœƒçˆ†æ± è¶…è®š\nç‰¹è£½æ²™æ‹‰é†¬ä¸€å®šè¦è©¦è©¦\n11æœˆ11æ—¥æ‰å‰›é–‹å¹•\n17è™Ÿå‰æœ‰50% OFF - Ribu Set ï¼ˆ5æŠ˜ï¼‰\n\nğŸ Tonkatsu AOKI @ICONSIAM\nğŸ“ICONSIAM 4F'
  },
  {
    id:'bkk-cafe-005',
    name:'Baan Suan Sathon à¸šà¹‰à¸²à¸™à¸ªà¸§à¸™à¸ªà¸²à¸—à¸£ à¸„à¸£à¸²à¸Ÿà¹à¸­à¸™à¸”à¹Œà¸„à¸²à¹€à¸Ÿà¹ˆ',
    category:'å’–å•¡å»³ / ç”œé»',
    area:'Sathon',
    price:'$$',
    address:'60 Chuea Phloeng 2 Alley, Thung Maha Mek, Sathon, Bangkok 10120, Thailand',
    maps:'https://maps.google.com/?q=Baan%20Suan%20Sathon%20Bangkok',
    cover:'https://scontent.cdninstagram.com/v/t51.82787-15/573308079_17906980539284647_7496302929886550097_n.jpg?stp=cmp1_dst-jpg_e35_s640x640_tt6&_nc_cat=103&ccb=7-5&_nc_sid=18de74&efg=eyJlZmdfdGFnIjoiQ0xJUFMuYmVzdF9pbWFnZV91cmxnZW4uQzMifQ%3D%3D&_nc_ohc=1UHCoezQcOoQ7kNvwF3jJUz&_nc_oc=AdkXz9_yTBemWacuge2q3xPeC98nW3J8LkNulgmS7nPCKqPlfeVUaukh2fihvw472bTZzfiB1RV1Zgo6IJpp7dh9&_nc_zt=23&_nc_ht=scontent.cdninstagram.com&_nc_gid=nWRP-ffUHcc0M8dsfxiQIQ&oh=00_Afn5XAK9im3lBBKIAbFYE-hjHGAbgcVC_1tSUKeXp76OXw&oe=69588AE7',
    ig:'https://www.instagram.com/p/DQrANV0k-r6/',
    intro:'é€™è£¡å°±åƒæ˜¯åœ¨æ›¼è°·å¸‚ä¸­å¿ƒçš„ç¶ é‡ä»™è¹¤\nä½åœ¨æ²™åå€çš„å°å··è£¡\nå°±åœ¨One Bangkoké™„è¿‘ä¸é \nä¸€èµ°é€²å»å°±åƒé€²å…¥é›²ç…™è£Šè£Šçš„ä¸–å¤–æ¡ƒæº\nç€‘å¸ƒã€éœ§æ°£ã€é­šæ± èˆ‡æ»¿æ»¿çš„ç¶ æ„äº¤ç¹”å‡ºä¸€ç¨®å¤¢å¹»æ°›åœ\nåœ¨é€™è£¡åƒé£¯å°±åƒæ˜¯åœ¨æ£®æ—è£¡ç”¨é¤\nå°¤å…¶æ˜¯ç€‘å¸ƒé‚Šçš„ä½ç½®ç‰¹åˆ¥æµªæ¼«\nç”œé»å’Œé£²å“ä¸åªå¥½æ‹é‚„è®“äººæ”¾é¬†\nå¾ˆå¤šäººæœƒå°ˆç¨‹ä¾†é€™è£¡å–å’–å•¡ã€åƒä¸‹åˆèŒ¶æˆ–æ‹ç…§æ‰“å¡\næˆ‘è‡ªå·±ä¹Ÿæ»¿å–œæ­¡è·Ÿæœ‹å‹ä¾†é€™èŠå¤©çš„\næœƒè®“è‡ªå·±çŸ­æš«é›¢é–‹åŸå¸‚çš„å–§å›‚\n\nğŸ Baan Suan Sathon à¸šà¹‰à¸²à¸™à¸ªà¸§à¸™à¸ªà¸²à¸—à¸£ à¸„à¸£à¸²à¸Ÿà¹à¸­à¸™à¸”à¹Œà¸„à¸²à¹€à¸Ÿà¹ˆ\nğŸ“60 Chuea Phloeng 2 Alley, Thung Maha Mek, Sathon, Bangkok 10120, Thailand'
  },
  {
    id:'bkk-thai-003',
    name:'GINGER FARM kitchen at central wOrld',
    category:'æ³°å¼æ–™ç†',
    area:'Central World',
    price:'$$',
    address:'Central World 5F, Bangkok',
    maps:'https://maps.google.com/?q=GINGER%20FARM%20kitchen%20central%20world',
    cover:'https://scontent.cdninstagram.com/v/t51.82787-15/572925681_17906199000284647_5377138717193685226_n.jpg?stp=cmp1_dst-jpg_e35_s640x640_tt6&_nc_cat=109&ccb=7-5&_nc_sid=18de74&efg=eyJlZmdfdGFnIjoiQ0xJUFMuYmVzdF9pbWFnZV91cmxnZW4uQzMifQ%3D%3D&_nc_ohc=3F69vV0VBZUQ7kNvwHL49wW&_nc_oc=AdkafRUM-u0d6Vyey72wUs4xcHU4Z6K9-QarBEd4eaIu1NtH75acKdQKfBKo9eR5xxdryA7HMC3Rmgriohy6Rf22&_nc_zt=23&_nc_ht=scontent.cdninstagram.com&_nc_gid=YJiklPaEKg7owV-vJrEwoA&oh=00_AfnmSrCOJbfAOSXjLacWK8PmB1zOkCV-kYO9baTGf98T-w&oe=6958964F',
    ig:'https://www.instagram.com/p/DQYPKnikx20/',
    intro:'æˆ‘å¾å¹¾å¹´å‰åœ¨æ¸…é‚ç¬¬ä¸€æ¬¡åƒåˆ° Ginger Farm Kitchen å°±æ„›ä¸Šäº†\né€™é–“é€£çºŒå¥½å¹¾å¹´éƒ½æ‹¿åˆ°ç±³å…¶æ—å¿…æ¯”ç™»æ¨è–¦\nç¾åœ¨åœ¨ Central World äº”æ¨“ä¹Ÿåƒå¾—åˆ°\nåœ°é»è¶…æ–¹ä¾¿ åº—å…§æ°£æ°›åˆå¥½\né¤å»³ä¸»æ‰“å¾è¾²å ´åˆ°é¤æ¡Œ æ‰€æœ‰é£Ÿæéƒ½æ˜¯æœ‰æ©Ÿçš„\nä»–å€‘çš„æ‹›ç‰Œè„†çš®è±¬äº”èŠ±çš®ç‚¸åˆ°å®Œç¾é‡‘é»ƒé…¥è„†\næ­é…ä¸‰ç¨®ç‰¹è£½é†¬æ± çœŸçš„è¶…æ¶®å˜´\nçƒ¤è¦ä¸€æ‰“é–‹è¦è†é‚„åœ¨æµ\né£²å“é¸æ“‡è¶…å¤š\næˆ‘æœ€æ¨è–¦æ°´æœå¥¶æ˜”ç³»åˆ—\næ¯æ¯å‘³é“éƒ½å¾ˆå¥½å–\næ•´é«”èœå–®è¶…è±å¯Œ\næ»¿æ¨è–¦ä¾†åƒåƒçœ‹é€™é–“çš„ï¼\n\nğŸ GINGER FARM kitchen at central wOrld\nğŸ“central world 5F'
  },
  {
    id:'bkk-thai-004',
    name:'KINKIN à¸à¸´à¸™à¸à¸´à¸™ Sukhumvit 47',
    category:'æ³°å¼æ–™ç†',
    area:'Thonglor',
    price:'$',
    address:'à¹€à¸¥à¸‚à¸—à¸µà¹ˆ 855, à¸›à¸²à¸ Sukhumvit Rd, Khlong Tan Nuea, Watthana, Bangkok 10110',
    maps:'https://maps.google.com/?q=KINKIN%20Sukhumvit%2047',
    cover:'https://scontent.cdninstagram.com/v/t51.82787-15/571173140_17905570194284647_178248499052412215_n.jpg?stp=cmp1_dst-jpg_e35_s640x640_tt6&_nc_cat=104&ccb=7-5&_nc_sid=18de74&efg=eyJlZmdfdGFnIjoiQ0xJUFMuYmVzdF9pbWFnZV91cmxnZW4uQzMifQ%3D%3D&_nc_ohc=WJhwRKy3QzUQ7kNvwEwMiIM&_nc_oc=AdmSfbHMAsqOmBX3PxTbJwSHWHflpIsdGWkzzh6kAAAHv7njzhLNY0oUF0Zh02kJGJcKs4nd8GplVUOKX3GbBqjv&_nc_zt=23&_nc_ht=scontent.cdninstagram.com&_nc_gid=x0RZn8aj4UID2o3-rSRnEg&oh=00_Afnu0TEcwkj4XdptqL6g3LAMAEyzp_kIuvmQLgDgtKInvw&oe=695886CE',
    ig:'https://www.instagram.com/p/DQIzWLnk5UJ/',
    intro:'ä¸‹åˆä¸‰é»è£¡é¢é‚„æ˜¯æ»¿åº§çš„æ³°èœé¤å»³\né€™é–“åœ¨æˆ‘å…¨å¹´å‰›ä¾†æ›¼è°·çš„æ™‚å€™\næœ‰çœ‹åˆ°ä»–é–‹å¹•\nå°±ä¸€ç›´å­˜åœ¨åœ°åœ–è£¡ ä½†éƒ½æ²’æ©Ÿæœƒå»\né€™æ¬¡å‰›å¥½ç¶“éæƒ³èªªé€²å»çœ‹çœ‹\nçµæœç•¶å¤©æ˜¯å¹³æ—¥ä¸‹åˆä¸‰é» ä¸€æ¨“ç«Ÿç„¶æ»¿åº§äº†\næˆ‘ä¸€æŸ¥google reviewé‚„æœ‰4.8é¡†æ˜Ÿ æ„Ÿè¦ºå¾ˆå€¼å¾—ä¸€è©¦\né€™é–“çš„æ³°èœéƒ½æ»¿å¥½åƒçš„\nä½ç½®ä¹Ÿå¾ˆæ–¹ä¾¿\nå°±åœ¨BTS THONGLORå‡ºç«™5åˆ†é˜\næ¨è–¦çµ¦å„ä½\n\nğŸ KINKIN à¸à¸´à¸™à¸à¸´à¸™ Sukhumvit 47\nğŸ“à¹€à¸¥à¸‚à¸—à¸µà¹ˆ 855, à¸›à¸²à¸ Sukhumvit Rd, Khlong Tan Nuea, Watthana, Bangkok 10110'
  },
  {
    id:'bkk-street-002',
    name:'à¸­à¸²à¹€à¸™à¸µà¹‰à¸¢à¸§à¹€à¸à¸²à¹€à¸«à¸¥à¸²à¹€à¸¥à¸·à¸­à¸”à¸«à¸¡à¸¹',
    category:'åœ¨åœ°å°åƒ',
    area:'Chom Thong',
    price:'$',
    address:'Suk Sawat Rd, Khwaeng Chom Thong, Khet Chom Thong, Bangkok 10150',
    maps:'https://maps.google.com/?q=%E0%B8%AD%E0%B8%B2%E0%B9%80%E0%B8%99%E0%B8%B5%E0%B9%89%E0%B8%A2%E0%B8%A7%E0%B9%80%E0%B8%81%E0%B8%B2%E0%B9%80%E0%B8%AB%E0%B8%A5%E0%B8%B2%E0%B9%80%E0%B8%A5%E0%B8%B7%E0%B8%AD%E0%B8%94%E0%B8%AB%E0%B8%A1%E0%B8%B9',
    cover:'https://scontent.cdninstagram.com/v/t51.71878-15/568198591_1567947324370538_8363863697411137942_n.jpg?stp=cmp1_dst-jpg_e35_s640x640_tt6&_nc_cat=105&ccb=7-5&_nc_sid=18de74&efg=eyJlZmdfdGFnIjoiQ0xJUFMuYmVzdF9pbWFnZV91cmxnZW4uQzMifQ%3D%3D&_nc_ohc=lx0MSL8Sj2gQ7kNvwGgTIge&_nc_oc=Adme6G_Y28NuU8zuidY-w9otG49rMUEU0QONSHfzVvv7ORW3jhS6celbPuK8CTUHdDPhcJSmr1h-W2jzx87qhCqd&_nc_zt=23&_nc_ht=scontent.cdninstagram.com&_nc_gid=Hl35eiz62QwGi0KBrZ7SBA&oh=00_AflAIW74YFbriZj9JiPAHGd78PA7J6x9HvNHugrEXs3akA&oe=69588532',
    ig:'https://www.instagram.com/p/DP77dFlE4pi/',
    intro:'æ›¼è°·å··å¼„å…§çš„é ‚ç´šè±¬é›œæ¹¯\né€™é–“æ˜¯æˆ‘çœ‹éå¾ˆå¤šæ³°åœ‹äººå»æ‰“å¡çš„\nä¸€é–“åœ¨å··å¼„å…§çš„è€åº—\næ—é‚Šå°±æ˜¯èœå¸‚å ´ å¾ˆå¥½é€›ä¹Ÿå¾ˆå¥½è²·\né€™é–“åº—çš„è€é—†å¨˜é‚„å¸¸ä¸Šæ³°åœ‹çš„ç¾é£Ÿç¯€ç›®\nä»–å€‘çš„è±¬é›œéƒ½è™•ç†çš„è¶…ä¹¾æ·¨\nå®Œå…¨æ²’è…¥å‘³åˆå¥½åƒ\næ¹¯é ­ä¹Ÿå¾ˆå¤ å‘³\nä¸éå†¬è”­åŠŸæ¹¯æ»¿è¾£çš„ æƒ³åƒçš„å¯ä»¥é»å¾®è¾£å°±å¥½\nå¦‚æœå–œæ­¡åœ¨åœ°å°åƒçš„äºº\næ‡‰è©²æœƒå¾ˆå–œæ­¡é€™é–“çš„å‘³é“ï½\næˆ‘å€‹äººä¹Ÿå¾ˆæ„›\n\nğŸ à¸­à¸²à¹€à¸™à¸µà¹‰à¸¢à¸§à¹€à¸à¸²à¹€à¸«à¸¥à¸²à¹€à¸¥à¸·à¸­à¸”à¸«à¸¡à¸¹\nğŸ“Suk Sawat Rd, Khwaeng Chom Thong, Khet Chom Thong, Bangkok 10150'
  },
  {
    id:'bkk-bbq-001',
    name:'The Secret Mookrata Sukhumvit 22',
    category:'æ³°å¼ç‡’çƒ¤ / å®µå¤œ',
    area:'Sukhumvit 22',
    price:'$',
    address:'Sukhumvit Alley 22, Khwaeng Khlong Tan, Khlong Toei, Bangkok 10110',
    maps:'https://maps.google.com/?q=The%20Secret%20Mookrata%20Sukhumvit%2022',
    cover:'https://scontent.cdninstagram.com/v/t51.82787-15/566286877_17904726588284647_2403826914159708826_n.jpg?stp=cmp1_dst-jpg_e35_s640x640_tt6&_nc_cat=104&ccb=7-5&_nc_sid=18de74&efg=eyJlZmdfdGFnIjoiQ0xJUFMuYmVzdF9pbWFnZV91cmxnZW4uQzMifQ%3D%3D&_nc_ohc=nrp2o5Yxi_kQ7kNvwGLyOp1&_nc_oc=AdlS-D3KsABBTsq54TzqP27PxdNs45MpAQTUTvTVswDEcw69iYCWHsgjlni2poENzTBVK0C0Eipb4ON5J2APPrtJ&_nc_zt=23&_nc_ht=scontent.cdninstagram.com&_nc_gid=abadoYmd2y--mbG4pSnJkA&oh=00_AfkchTcN5AQgGlz3AScHDBOnSCD3YwSVOFnfrLv48FIq9g&oe=6958AD4C',
    ig:'https://www.instagram.com/p/DP0TBScE-AU/',
    intro:'åœ¨æ›¼è°·å¸‚ä¸­å¿ƒé–‹åˆ°å¤©äº®çš„mookata\næˆ‘ä¸€å®šè¦è·Ÿå¤§å®¶æ¨è–¦é€™é–“\nä¹‹å‰æœ‹å‹åŠå¤œå¸¶æˆ‘ä¾†ä¸€æ¬¡ä¹‹å¾Œå°±æ„›ä¸Šäº†\nä¾†éæ›¼è°·æ—…éŠçš„äººæ‡‰è©²éƒ½çŸ¥é“\nåŠå¤œè¦åœ¨å¸‚å€æ‰¾åˆ°å¥½åƒçš„æ±è¥¿å¾ˆé›£\né€™é–“å°±åœ¨Sukhumvit 22å··è£¡é¢\nåœ°é»è¶…ç´šå¥½ é‚„é–‹åˆ°å¤©äº®\næˆ‘å€‘å¾ˆå¸¸å»é…’å§å–å®Œ2é»è·‘ä¾†é€™è£¡ç¹¼çºŒåƒ\nè£¡é¢çš„é£Ÿæéƒ½è¶…æ–°é®®å¥½åƒ\nç„¶å¾Œé‚£å€‹æ‰“è›‹é€²æ¹¯çš„åƒæ³•ä¸€å®šè¦å­¸\nåƒèµ·ä¾†æœƒå¾ˆåƒè’¸è›‹ ä½†å‘³é“æ›´å‹ä¸€ç±Œ\nè«‹åˆ—å…¥ä¾†æ›¼è°·å¿…åƒå®µå¤œ\n\nğŸ The Secret Mookrata Sukhumvit 22\nğŸ“Sukhumvit Alley 22, Khwaeng Khlong Tan, Khlong Toei, Bangkok 10110'
  }
];

function escapeHtml(s){
  return String(s ?? '').replace(/[&<>"']/g, c=>({
    "&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"
  }[c]));
}
function safeUrl(input){
  const raw = String(input || '').trim();
  if (!raw) return '';
  try{
    const u = new URL(raw, window.location.origin);
    if (u.protocol === 'http:' || u.protocol === 'https:') return u.href;
  }catch(_){}
  return '';
}
function buildInstagramEmbedUrl(input){
  const raw = safeUrl(input);
  if (!raw) return '';
  try{
    const u = new URL(raw);
    const host = (u.hostname || '').toLowerCase();
    if (!host.endsWith('instagram.com')) return '';
    if (!/^\/(p|reel|tv)\//.test(u.pathname)) return '';
    const cleanPath = u.pathname.replace(/\/?$/, '/');
    return `${u.origin}${cleanPath}embed`;
  }catch(_){ return ''; }
}
function buildIntroText(item){
  const intro = (item && item.intro) ? String(item.intro).trim() : '';
  if (intro) return intro;
  const parts = [];
  const highlights = Array.isArray(item && item.highlights) ? item.highlights.filter(Boolean) : [];
  if (highlights.length){
    parts.push(`äº®é»ï¼š${highlights.join('ã€')}`);
  }
  const dishes = Array.isArray(item && item.dishes) ? item.dishes.filter(d=>d && (d.name || d.price)) : [];
  if (dishes.length){
    const dishLine = dishes.map(d=>{
      const name = d.name ? String(d.name).trim() : '';
      const price = d.price ? `à¸¿${String(d.price).trim()}` : '';
      return [name, price].filter(Boolean).join(' ');
    }).filter(Boolean).join('ã€');
    if (dishLine) parts.push(`æ¨è–¦é¤é»ï¼š${dishLine}`);
  }
  return parts.join('ã€‚');
}

const cardsEl = document.getElementById('cards');
const fCat = document.getElementById('fCat');
const fArea = document.getElementById('fArea');
const fPrice = document.getElementById('fPrice');
const kwInput = document.getElementById('kw');
const btnBack = document.getElementById('btnBack');
const btnFav = document.getElementById('btnFav');
const btnAdmin = document.getElementById('btnAdmin');

let DATA = BASE_DATA.slice();
let favs = [];
let adminMode = false;
const ADMIN_KEY = 'foodMapAdminMode';

function resetFilters(){
  if (kwInput) kwInput.value = '';
  if (fCat) fCat.value = '';
  if (fArea) fArea.value = '';
  if (fPrice) fPrice.value = '';
}

function getAdminMode(){
  try{
    const params = new URLSearchParams(location.search);
    if (params.get('admin') === '1') return true;
    return localStorage.getItem(ADMIN_KEY) === '1';
  }catch(_){
    return false;
  }
}
function setAdminMode(next){
  adminMode = !!next;
  try{ localStorage.setItem(ADMIN_KEY, adminMode ? '1' : '0'); }catch(_){}
  document.body.classList.toggle('admin-editing', adminMode);
  if (btnAdmin) btnAdmin.textContent = adminMode ? 'å®Œæˆç·¨è¼¯' : 'ç®¡ç†ç·¨è¼¯';
}

function initFilters(){
  fCat.innerHTML = '<option value=\"\">å…¨éƒ¨åˆ†é¡</option>';
  fArea.innerHTML= '<option value=\"\">å…¨éƒ¨åœ°å€</option>';
  const cats = Array.from(new Set(DATA.map(d=>d.category))).sort();
  cats.forEach(c=>{ const opt=document.createElement('option');opt.value=c;opt.textContent=c;fCat.appendChild(opt); });
  const areas = Array.from(new Set(DATA.map(d=>d.area))).sort();
  areas.forEach(a=>{ const opt=document.createElement('option');opt.value=a;opt.textContent=a;fArea.appendChild(opt); });
}

function render(){
  const kw = (kwInput.value||'').trim().toLowerCase();
  const cat = fCat.value;
  const area= fArea.value;
  const price= fPrice.value;
  const list = DATA.filter(item=>{
    if (kw && !JSON.stringify(item).toLowerCase().includes(kw)) return false;
    if (cat && item.category !== cat) return false;
    if (area && item.area !== area) return false;
    if (price && item.price !== price) return false;
    return true;
  });
  if (!list.length){
    cardsEl.innerHTML = `
      <div class="empty-state">
        <h3>ç›®å‰æ²’æœ‰ç¬¦åˆçš„åº—å®¶</h3>
        <p>å¯ä»¥æ¸…é™¤ç¯©é¸æˆ–ç¨å¾Œå†è©¦ã€‚</p>
        <button class="btn ghost pill" type="button" id="clearFiltersBtn">æ¸…é™¤ç¯©é¸</button>
      </div>
    `;
    const clearBtn = document.getElementById('clearFiltersBtn');
    if (clearBtn){
      clearBtn.onclick = ()=>{ resetFilters(); render(); };
    }
    return;
  }
  cardsEl.innerHTML = list.map(item=>{
    const tags = [item.category, item.area, item.price ? `åƒ¹ä½ï¼š${item.price}` : '']
      .filter(Boolean)
      .map(t=>`<span class="tag">${escapeHtml(t)}</span>`)
      .join('');
    const liked = favs.includes(item.id);
    const safeId = escapeHtml(item.id || '');
    const safeName = escapeHtml(item.name || '');
    const coverUrl = safeUrl(item.cover);
    const coverImg = coverUrl ? `<img src="${escapeHtml(coverUrl)}" alt="${safeName}">` : '';
    const mapsUrl = safeUrl(item.maps);
    const introText = buildIntroText(item);
    const adminPanel = adminMode ? `
      <div class="admin-panel" data-admin-id="${safeId}">
        <div class="admin-grid">
          <label>åº—å<input class="admin-input" data-admin-field="name" value="${safeName}"></label>
          <label>åˆ†é¡<input class="admin-input" data-admin-field="category" value="${escapeHtml(item.category || '')}"></label>
          <label>åœ°å€<input class="admin-input" data-admin-field="area" value="${escapeHtml(item.area || '')}"></label>
          <label>åƒ¹ä½<input class="admin-input" data-admin-field="price" value="${escapeHtml(item.price || '')}"></label>
          <label>åœ°å€<input class="admin-input" data-admin-field="address" value="${escapeHtml(item.address || '')}"></label>
          <label>Google Maps<input class="admin-input" data-admin-field="maps" value="${escapeHtml(item.maps || '')}"></label>
          <label>IG å½±ç‰‡<input class="admin-input" data-admin-field="ig" value="${escapeHtml(item.ig || '')}"></label>
          <label>å°é¢åœ–<input class="admin-input" data-admin-field="cover" value="${escapeHtml(item.cover || '')}"></label>
        </div>
        <label class="admin-field">åº—å®¶ä»‹ç´¹
          <textarea class="admin-textarea" data-admin-field="intro">${escapeHtml(introText)}</textarea>
        </label>
        <div class="admin-actions">
          <button class="btn ghost" data-admin-save="${safeId}">å„²å­˜</button>
        </div>
        <div class="admin-hint">ç®¡ç†æ¨¡å¼ï¼šå„²å­˜å¾Œæœƒç›´æ¥å¯«å…¥è³‡æ–™åº«ã€‚</div>
      </div>
    ` : '';
    return `<article class="card">
      <div class="cover">${coverImg}</div>
      <div class="card-body">
        <div class="card-head">
          <div>
            <div class="card-title">${safeName}</div>
            <div class="card-sub">${escapeHtml(item.category || '')} Â· ${escapeHtml(item.area || '')}${item.price ? ` Â· åƒ¹ä½ ${escapeHtml(item.price)}` : ''}</div>
          </div>
          <button class="fav-btn" data-fav="${safeId}" title="æ”¶è—">${liked?'â˜…':'â˜†'}</button>
        </div>
        <div class="card-tags">${tags}<span class="badge-hot">æ¨è–¦</span></div>
        <div class="card-addr">${escapeHtml(item.address || '')}</div>
        <div class="card-actions">
          <button class="btn primary" data-open="${safeId}">æŸ¥çœ‹åº—å®¶è³‡è¨Š</button>
          <a class="btn ghost" href="${escapeHtml(mapsUrl || '#')}" target="_blank" rel="noopener">åœ°åœ–å°èˆª</a>
        </div>
        ${adminPanel}
      </div>
    </article>`;
  }).join('');
  // ç¶å®šå¡ç‰‡æŒ‰éˆ•
  cardsEl.querySelectorAll('button[data-open]').forEach(btn=>{
    btn.onclick = (ev)=>{
      const id = btn.getAttribute('data-open');
      openModal(id);
    };
  });
  cardsEl.querySelectorAll('button[data-fav]').forEach(btn=>{
    btn.onclick = async ()=>{
      const id = btn.getAttribute('data-fav');
      try{
        const action = favs.includes(id) ? 'remove' : 'add';
        const res = await fetch('/api/me/food-favs', {
          method:'POST',
          headers:{'Content-Type':'application/json'},
          credentials:'include',
          body: JSON.stringify({ id, action })
        });
        const data = await res.json().catch(()=>({}));
        if (res.status === 401){
          alert('è«‹å…ˆç™»å…¥å¾Œå†æ”¶è—');
          return;
        }
        if (!res.ok || !data.ok) throw new Error(data.error || ('HTTP '+res.status));
        favs = data.favorites || [];
        render();
      }catch(err){
        alert('æ”¶è—å¤±æ•—ï¼š'+ (err.message||err));
      }
    };
  });
  if (adminMode){
    cardsEl.querySelectorAll('[data-admin-save]').forEach(btn=>{
      btn.onclick = async ()=>{
        const wrap = btn.closest('[data-admin-id]');
        if (!wrap) return;
        const id = wrap.getAttribute('data-admin-id');
        const read = (field)=>{
          const el = wrap.querySelector(`[data-admin-field="${field}"]`);
          return el ? el.value.trim() : '';
        };
        const introRaw = read('intro');
        const introLines = introRaw.split(/\n+/).filter(Boolean);
        const payload = {
          id: id || undefined,
          name: read('name'),
          category: read('category'),
          area: read('area'),
          price: read('price'),
          address: read('address'),
          maps: read('maps'),
          ig: read('ig'),
          cover: read('cover'),
          intro: introRaw,
          highlights: introLines,
          dishes: []
        };
        try{
          btn.disabled = true;
          const res = await fetch('/api/foods', {
            method:'POST',
            headers:{'Content-Type':'application/json'},
            credentials:'include',
            body: JSON.stringify(payload)
          });
          const data = await res.json().catch(()=>({}));
          if (res.status === 401){
            alert('éœ€è¦ç®¡ç†å“¡æ¬Šé™æ‰èƒ½ç·¨è¼¯ã€‚');
            return;
          }
          if (!res.ok || !data.ok) throw new Error(data.error || ('HTTP '+res.status));
          await loadRemote();
        }catch(err){
          alert('å„²å­˜å¤±æ•—ï¼š' + (err.message||err));
        }finally{
          btn.disabled = false;
        }
      };
    });
  }
}

// æŒ‰éˆ•äº‹ä»¶
[btnBack, btnFav, btnAdmin].forEach(btn=>{
  if (!btn) return;
  if (btn.id === 'btnBack') btn.onclick = ()=> history.back();
});
if (btnFav) btnFav.onclick = ()=> openFavList();
if (btnAdmin) btnAdmin.onclick = ()=>{ setAdminMode(!adminMode); render(); };

adminMode = getAdminMode();
setAdminMode(adminMode);
initFilters();
resetFilters();
render();
[kwInput, fCat, fArea, fPrice].forEach(el=> el.addEventListener('input', render));

// è®€å–é ç«¯è³‡æ–™èˆ‡æ”¶è—
async function loadRemote(){
  try{
    const res = await fetch('/api/foods',{cache:'no-store'});
    const data = await res.json().catch(()=>({}));
    if (res.ok && Array.isArray(data.items)){
      if (data.items.length){
        const map = new Map();
        BASE_DATA.forEach(item=>{
          if (item && item.id) map.set(item.id, item);
        });
        const extra = [];
        data.items.forEach((item, idx)=>{
          if (item && item.id){
            map.set(item.id, item);
          }else if (item){
            extra.push(item);
          }
        });
        DATA = [...map.values(), ...extra];
      }else{
        DATA = BASE_DATA.slice();
      }
    }
  }catch(_){}
  if (!DATA.length){
    DATA = BASE_DATA.slice();
  }
  await refreshFavorites();
  initFilters();
  render();
}
loadRemote();

// Modalï¼šåº—å®¶è³‡è¨Š
function openModal(id){
  const item = DATA.find(x=>x.id===id);
  if (!item) return;
  const body = document.getElementById('foodModalBody');
  const dlg = document.getElementById('foodModal');
  const introText = buildIntroText(item);
  const embedUrl = buildInstagramEmbedUrl(item.ig);
  const iframe = embedUrl ? `<iframe src="${escapeHtml(embedUrl)}" style="width:100%;min-height:420px;border:none;"></iframe>` : '';
  const mapsUrl = safeUrl(item.maps);
  const safeId = escapeHtml(item.id || '');
  body.innerHTML = `
    <div style="padding:16px;display:grid;gap:12px;background:#fff;max-height:80vh;overflow:auto;">
      <div style="display:flex;justify-content:space-between;align-items:center;gap:10px;">
        <div style="font-size:18px;font-weight:800;">${escapeHtml(item.name || '')}</div>
        <button id="foodClose" style="border:none;background:#f1f5f9;border-radius:10px;padding:6px 10px;cursor:pointer;">é—œé–‰</button>
      </div>
      <div style="border-radius:12px;overflow:hidden;background:#f8fafc;">${iframe || '<div style="padding:20px;color:#94a3b8;">ç„¡ IG å½±ç‰‡</div>'}</div>
      <div style="font-size:14px;color:#0f172a;line-height:1.7;">
        <div><strong>åœ°å€ï¼š</strong>${escapeHtml(item.address || '')}</div>
        <div><strong>åˆ†é¡ï¼š</strong>${escapeHtml(item.category || '')}ï½œ${escapeHtml(item.area || '')}ï½œåƒ¹ä½ï¼š${escapeHtml(item.price || '')}</div>
      </div>
      <div>
        <strong>åº—å®¶ä»‹ç´¹ï¼š</strong>
        <div style="margin:6px 0 0;color:#475569;white-space:pre-wrap;">${escapeHtml(introText || 'æš«ç„¡ä»‹ç´¹')}</div>
      </div>
      <div style="display:flex;gap:8px;flex-wrap:wrap;">
        <a class="btn primary" style="flex:1;" href="${escapeHtml(mapsUrl || '#')}" target="_blank" rel="noopener">é–‹å•Ÿ Google Maps</a>
        <button class="btn ghost" style="flex:1;" data-fav="${safeId}">åŠ å…¥æ”¶è—</button>
      </div>
    </div>
  `;
  dlg.showModal();
  document.getElementById('foodClose').onclick = ()=> dlg.close();
  const favBtn = body.querySelector('button[data-fav]');
  if (favBtn){ favBtn.onclick = ()=> toggleFav(item.id); }
}

// æ”¶è—æ¸…å–®èˆ‡æ”¶è— API
async function refreshFavorites(){
  try{
    const r = await fetch('/api/me/food-favs',{credentials:'include',cache:'no-store'});
    const j = await r.json().catch(()=>({}));
    if (r.ok && Array.isArray(j.favorites)){
      favs = j.favorites;
      render();
    }
    return r.ok;
  }catch(_){ return false; }
}
async function toggleFav(id){
  try{
    const action = favs.includes(id) ? 'remove' : 'add';
    const res = await fetch('/api/me/food-favs',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      credentials:'include',
      body: JSON.stringify({ id, action })
    });
    const data = await res.json().catch(()=>({}));
    if (res.status === 401){ alert('è«‹å…ˆç™»å…¥å¾Œå†æ”¶è—'); return; }
    if (!res.ok || !data.ok) throw new Error(data.error || ('HTTP '+res.status));
    favs = data.favorites || [];
    render();
  }catch(err){
    alert('æ”¶è—å¤±æ•—ï¼š' + (err.message||err));
  }
}
function openFavList(){
  const dlg = document.getElementById('foodModal');
  const body = document.getElementById('foodModalBody');
  const list = DATA.filter(it=> favs.includes(it.id));
  body.innerHTML = `
    <div style="padding:16px;display:grid;gap:12px;background:#fff;max-height:80vh;overflow:auto;">
      <div style="display:flex;justify-content:space-between;align-items:center;">
        <div style="font-size:18px;font-weight:800;">æ”¶è—æ¸…å–®</div>
        <button id="foodClose" style="border:none;background:#f1f5f9;border-radius:10px;padding:6px 10px;cursor:pointer;">é—œé–‰</button>
      </div>
      ${!list.length ? '<div style="color:#94a3b8;">ç›®å‰æ²’æœ‰æ”¶è—ã€‚</div>' : `
        <div style="display:grid;gap:8px;">
          ${list.map(it=>`<div style="display:flex;justify-content:space-between;align-items:center;padding:8px 10px;border:1px solid #e5e7eb;border-radius:10px;">
            <div>
              <div style="font-weight:700;">${escapeHtml(it.name || '')}</div>
              <div style="color:#64748b;font-size:12px;">${escapeHtml(it.category || '')}ï½œ${escapeHtml(it.area || '')}</div>
            </div>
            <div style="display:flex;gap:6px;">
              <button class="btn ghost" style="padding:6px 10px;font-size:12px;" data-open="${escapeHtml(it.id || '')}">æŸ¥çœ‹</button>
              <button class="btn" style="padding:6px 10px;font-size:12px;" data-remove="${escapeHtml(it.id || '')}">ç§»é™¤</button>
            </div>
          </div>`).join('')}
        </div>
      `}
    </div>
  `;
  dlg.showModal();
  document.getElementById('foodClose').onclick = ()=> dlg.close();
  body.querySelectorAll('button[data-open]').forEach(btn=>{
    btn.onclick = ()=> openModal(btn.getAttribute('data-open'));
  });
  body.querySelectorAll('button[data-remove]').forEach(btn=>{
    btn.onclick = ()=> removeFav(btn.getAttribute('data-remove'));
  });
}
async function removeFav(id){
  try{
    const res = await fetch('/api/me/food-favs',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      credentials:'include',
      body: JSON.stringify({ id, action:'remove' })
    });
    const data = await res.json().catch(()=>({}));
    if (res.status === 401){ alert('è«‹å…ˆç™»å…¥å¾Œå†æ“ä½œ'); return; }
    if (!res.ok || !data.ok) throw new Error(data.error || ('HTTP '+res.status));
    favs = data.favorites || [];
    render();
    const dlg = document.getElementById('foodModal');
    if (dlg.open) openFavList();
  }catch(err){
    alert('ç§»é™¤å¤±æ•—ï¼š' + (err.message||err));
  }
}

</script>
</body>
</html>
