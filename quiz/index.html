<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="測驗與您有緣的守護神，快速完成題目取得守護神結果與建議。">
  <link rel="canonical" href="https://unalomecodes.com/quiz">
  <title>測驗與您有緣的守護神</title>
  <link rel="stylesheet" href="/css/quiz-index.inline-1.css">
</head>
<body class="quiz-page">
  <header class="site-header">
    <div class="nav-shell">
      <a class="brand" href="/">
        <picture class="brand-logo">
          <source srcset="/img/logo.svg" type="image/svg+xml">
          <img id="brandLogo" src="/img/logo.png" alt="unalomecodes">
        </picture>
      </a>
      <div class="nav-title" data-i18n="quiz-nav-title">守護神測驗</div>
      <div class="nav-actions">
        <button type="button" class="btn btn-ghost" data-fortune-btn data-i18n="quiz-nav-fortune">領取日籤</button>
        <a class="btn btn-primary" href="/shop" data-i18n="quiz-nav-shop">前往商城</a>
        <button class="btn btn-ghost lang-toggle" id="langToggle" type="button" aria-label="切換語言">ZH/EN</button>
      </div>
    </div>
  </header>

  <main class="wrap">
    <section class="card intro-card" id="quizIntro">
      <span class="kicker" data-i18n="quiz-intro-kicker">守護神測驗</span>
      <h1 data-i18n="quiz-intro-title">用測驗找出此刻最適合你的守護神</h1>
      <p class="lead" data-i18n="quiz-intro-lead">1 分鐘完成，結果會推薦神祇與下一步（寺廟/商品/內容）</p>
      <div class="quiz-methodology">
        <p data-i18n="quiz-method-line-1">1 分鐘完成測驗</p>
        <p data-i18n="quiz-method-line-2">我們會依你的當下狀態與選擇，匹配最適合你的守護</p>
        <p data-i18n="quiz-method-line-3">結果包含命中指引、行動建議與可下載的守護卡</p>
      </div>
      <div class="intro-actions">
        <button class="btn btn-primary" id="startQuizBtn" type="button" data-i18n="quiz-intro-start">開始測驗</button>
        <button class="btn" id="resumeQuizBtn" type="button" style="display:none;" data-i18n="quiz-intro-resume">繼續上次</button>
        <button class="btn btn-ghost" id="previewBtn" type="button" data-i18n="quiz-intro-preview">先看看測驗會問什麼</button>
      </div>
      <details class="intro-details" id="quizPreview">
        <summary data-i18n="quiz-intro-summary">測驗會問什麼</summary>
        <ul>
          <li data-i18n="quiz-intro-item-1">出生星期與星座（快速定位個人能量）</li>
          <li data-i18n="quiz-intro-item-2">7 題生活與意圖題（推導最合拍的守護神）</li>
          <li data-i18n="quiz-intro-item-3">結果會給你下一步建議（寺廟、商品、內容）</li>
        </ul>
      </details>
      <div class="save-hint" id="saveHint" style="display:none;" data-i18n="quiz-save-hint">已自動保存作答</div>
    </section>

    <section class="quiz-flow" id="quizFlow" hidden>
      <div class="flow-head">
        <button type="button" class="btn btn-ghost" id="backBtn" data-i18n="quiz-back">← 上一題</button>
        <div class="progress" aria-live="polite">
          <div class="progress-label" id="progressLabel">步驟 1/9</div>
          <div class="progress-bar" aria-hidden="true"><span id="progressFill"></span></div>
        </div>
        <button type="button" class="btn btn-ghost" id="restartBtn" data-i18n="quiz-restart">重新開始</button>
      </div>

      <div class="card question-card step-card" id="stepDow">
        <fieldset class="option-fieldset">
          <legend data-i18n="quiz-dow-legend">你是星期幾出生？</legend>
          <div id="dowBox" class="option-grid" role="radiogroup" aria-label="weekday"></div>
        </fieldset>
      </div>

      <div class="card question-card step-card" id="stepZod">
        <fieldset class="option-fieldset">
          <legend data-i18n="quiz-zod-legend">你的星座？</legend>
          <div id="zodiacBox" class="option-grid" role="radiogroup" aria-label="zodiac"></div>
        </fieldset>
      </div>

      <div class="card question-card step-card" id="quizBox">
        <fieldset class="option-fieldset">
          <legend id="qTitle"></legend>
          <div id="opts" class="option-grid" role="radiogroup" aria-label="question-options"></div>
        </fieldset>
      </div>

      <div class="flow-actions">
        <button id="nextStepBtn" class="btn btn-primary" type="button" disabled data-i18n="quiz-next">下一步</button>
      </div>
    </section>

    <section class="card line-entry-card" id="lineFortuneEntry" style="display:none">
      <h2 data-i18n="line-entry-title">已完成守護神測驗</h2>
      <p class="muted" data-i18n="line-entry-desc">系統已讀取你的守護神紀錄，可直接領取日籤或重新測驗。</p>
      <div id="lineGuardianBadge" class="guardian-badge" style="display:none;"></div>
      <div class="line-entry-actions">
        <button type="button" class="btn btn-ghost" id="lineRetakeBtn" data-i18n="line-entry-retake">重新測驗守護神</button>
      </div>
    </section>

    <section class="card result-card" id="resultBox" style="display:none">
      <div class="result-head">
        <div class="kicker" data-i18n="result-kicker">測驗結果</div>
        <h2 id="resultTitle">你的守護神</h2>
        <div class="result-head-actions">
          <button id="retakeBtn" class="btn btn-ghost btn-text" type="button" data-i18n="cta-retake">重新測驗一次</button>
          <span id="retakeCooldown" class="retake-cooldown"></span>
        </div>
      </div>
      <div class="result-member-hint" id="membershipPrompt" hidden>
        <p>登入會員後，你的守護神徽章會顯示在會員中心，並可於台灣時間午夜 12 點領取今日日籤。</p>
        <a href="/api/auth/google/login?redirect=/quiz" class="btn btn-primary btn-sm">登入會員</a>
      </div>

      <div class="result-main">
        <div class="primary-stack">
          <div class="card hook-card">
            <p class="lead" id="resultHook"></p>
            <p class="muted" id="resultSummary"></p>
          </div>
          <div id="primaryDeityProfile"></div>
          <div class="card why-card">
            <h3 data-i18n="result-why-title">為什麼是祂</h3>
            <ul class="result-list" id="evidenceList"></ul>
          </div>
        </div>
        <div class="result-aside">
          <div class="card influence-card">
            <div class="section-head">
              <h3 data-i18n="result-influence-title">影響來源說明</h3>
            </div>
            <div class="influence-body">
              <p data-i18n="result-influence-line-1">本次結果主要依據你當下的行動選擇與核心意圖。</p>
              <p data-i18n="result-influence-line-2">出生能量僅作為背景參考。</p>
              <p data-i18n="result-influence-line-3">系統綜合以上因素，找出此刻最適合你的守護神。</p>
            </div>
            <details class="influence-details">
              <summary data-i18n="result-influence-summary">系統判斷摘要</summary>
              <div class="affinity-meta">
                <span class="step" data-i18n="result-affinity-title">緣分值</span>
                <span class="affinity-value" id="affText">—</span>
              </div>
              <div class="bar"><div id="affBar" class="fill"></div></div>
              <div class="affinity-breakdown" id="affBreakdown"></div>
            </details>
          </div>
          <div class="card secondary-card">
            <h3 data-i18n="result-secondary-title">副守護神</h3>
            <div id="secondaryDeityCard"></div>
          </div>
        </div>
      </div>

      <div class="card stories-card">
        <div class="section-head">
          <h3 data-i18n="result-stories-title">真實故事</h3>
        </div>
        <div class="story-list" id="deityStories"></div>
      </div>

      <div class="card actions-card">
        <div class="section-head">
          <h3 data-i18n="result-actions-title">接下來怎麼做</h3>
        </div>
        <div class="action-grid" id="actionList"></div>
        <div class="muted disclaimer" data-i18n="disclaimer">自我覺察與文化體驗建議，不構成保證。</div>
      </div>

      <div class="card guardian-card">
        <div class="section-head">
          <h3 data-i18n="result-card-title">你的守護卡</h3>
        </div>
        <div class="guardian-card-body">
        <div class="guardian-card-preview" id="guardianCardPreview">
          <div class="guardian-card-brand">unalomecodes</div>
          <div class="guardian-card-title" id="guardianCardTitle">—</div>
          <div class="guardian-card-role" id="guardianCardRole">—</div>
        <div class="guardian-card-summary" id="guardianCardSummary">—</div>
        <div class="guardian-card-tags" id="guardianCardKeywords"></div>
        <div class="guardian-card-note" id="guardianCardNote" data-i18n="result-card-note">這張卡可作為你近期的提醒與行動指引</div>
        <div class="guardian-card-transfer" id="guardianCardTransfer" data-i18n="result-card-transfer-line">這張卡代表我現在最需要的守護</div>
        <div class="guardian-card-date" id="guardianCardDate">—</div>
        <div class="save-state-hint">
          <button id="saveStateBtn" class="save-state-btn" type="button"></button>
        </div>
      </div>
    </div>
  </div>

      <div class="card advice-card">
        <div class="advice-head">
          <h3 data-i18n="result-amulet-title">佛牌配戴建議</h3>
          <button id="getCouponBtn" class="btn btn-primary" data-i18n="cta-coupon">點我領取專屬優惠</button>
        </div>
        <div id="amuletAdvice" class="result" style="display:none">載入中…</div>
        <div id="couponWrap" class="result" style="display:none"></div>
        <div class="coupon-actions">
          <button id="copyCouponBtn" class="btn btn-ghost" style="display:none" data-i18n="cta-copy-coupon">複製優惠碼</button>
          <button id="saveCouponBtn" class="btn" style="display:none" data-i18n="cta-save-coupon">存到我的優惠券</button>
        </div>
      </div>

      <div class="card member-card">
        <h3 data-i18n="member-title">完成後你會獲得</h3>
        <ul>
          <li data-i18n="member-line-1">你的守護神會顯示在會員中心旁邊，方便隨時查看。</li>
          <li data-i18n="member-line-2">每天台灣時間午夜 12 點可領取一次日籤。</li>
          <li data-i18n="member-line-3">日籤包含：守護神提醒、今日能量建議、生活小提示與加持方向。</li>
        </ul>
      </div>

      <div class="card user-stories-card" id="userStoriesWrap"></div>

      <div class="cta-primary cta-main">
        <a id="ctaShopPrimaryBtn" class="btn btn-primary btn-cta-main" href="/shop" data-i18n="quiz-cta-shop-primary">查看你的配戴建議</a>
      </div>
      <div class="cta-secondary">
        <a id="ctaTempleBtn" class="btn btn-ghost btn-cta-secondary" href="/templemap" data-i18n="quiz-cta-temple">前往寺廟地圖</a>
        <a id="deityLink" target="_blank" rel="noopener" class="btn btn-ghost btn-cta-secondary" data-i18n="quiz-cta-deity">查看完整神祇介紹</a>
      </div>
      <div class="guardian-share-hint" data-i18n="result-card-share-hint">分享給朋友，看看你們的守護是否互補</div>
      <div class="cta-aux">
        <button id="guardianCardDownloadBtn" class="btn btn-ghost btn-aux" type="button">
          <span class="btn-icon" aria-hidden="true">⬇</span>
          <span data-i18n="result-card-download">下載卡片</span>
        </button>
        <button id="guardianCardCopyBtn" class="btn btn-ghost btn-aux" type="button">
          <span class="btn-icon" aria-hidden="true">⧉</span>
          <span data-i18n="result-card-copy">複製分享文案</span>
        </button>
      </div>
    </section>

    <dialog id="fortuneDialogQuiz" class="fortune-dialog">
      <div class="fortune-shell">
        <div class="fortune-head">
          <div>
            <div class="fortune-title">今日專屬日籤</div>
            <div class="fortune-date" id="fortuneDateQuiz">—</div>
          </div>
          <button type="button" class="fortune-close" id="fortuneCloseQuiz">✕</button>
        </div>
        <div class="fortune-body">
          <div id="fortuneLoadingQuiz" class="fortune-loading">正在翻牌中…</div>
          <div id="fortuneErrorQuiz" class="fortune-error" style="display:none;"></div>
          <div id="fortuneCardQuiz" class="fortune-card" style="display:none;">
            <div class="fortune-stars" id="fortuneStarsQuiz"></div>
            <div class="fortune-summary" id="fortuneSummaryQuiz"></div>
            <div class="fortune-section">
              <div class="fortune-label">生活小建議</div>
              <div class="fortune-text" id="fortuneAdviceQuiz"></div>
            </div>
            <div class="fortune-section">
              <div class="fortune-label" id="fortuneRitualLabelQuiz">守護神想對你說</div>
              <div class="fortune-text" id="fortuneRitualQuiz"></div>
            </div>
            <div class="fortune-meta" id="fortuneMetaQuiz"></div>
          </div>
        </div>
      </div>
    </dialog>
  </main>
  <script src="/js/quiz-index.inline-1.js"></script>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <script src="/js/auth.js?v=20240930"></script>
  <script src="/js/deities-store.js"></script>
  <script src="/js/deity.inline-1.js"></script>
  <script src="/js/deity-components.js"></script>
  <div id="resultLoading" class="loading-overlay" role="status" aria-live="polite">
    <div class="loading-card">
      <div class="loading-spinner" aria-hidden="true"></div>
      <div class="loading-title">守護神感應中…</div>
      <div class="loading-sub">請稍候</div>
    </div>
  </div>

<script src="/js/quiz-index.inline-2.js"></script>
</body>
</html>
