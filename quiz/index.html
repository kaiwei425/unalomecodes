<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="測驗與您有緣的守護神，快速完成題目取得守護神結果與建議。">
  <link rel="canonical" href="https://unalomecodes.com/quiz">
  <title>測驗與您有緣的守護神</title>
  <link rel="stylesheet" href="/css/quiz-index.inline-1.css">
  <meta name="quiz-token" content="quiz_5A9kU3tZmE4hW2xP7qL8vN0r">
</head>
<body class="quiz-page">
  <header class="site-header">
    <div class="nav-shell">
      <a class="brand" href="/">
        <picture class="brand-logo">
          <source srcset="/img/logo.svg" type="image/svg+xml">
          <img id="brandLogo" src="/img/logo.png" alt="unalomecodes">
        </picture>
      </a>
      <div class="nav-title">守護神測驗</div>
      <div class="nav-actions">
        <button type="button" class="btn btn-ghost" data-fortune-btn>領取日籤</button>
        <a class="btn btn-primary" href="/shop">前往商城</a>
      </div>
    </div>
  </header>

  <main class="wrap">
    <section class="card intro-card" id="quizIntro">
      <span class="kicker">守護神測驗</span>
      <h1>用測驗找出此刻最適合你的守護神</h1>
      <p class="lead">1 分鐘完成，結果會推薦神祇與下一步（寺廟/商品/內容）</p>
      <div class="intro-actions">
        <button class="btn btn-primary" id="startQuizBtn" type="button">開始測驗</button>
        <button class="btn" id="resumeQuizBtn" type="button" style="display:none;">繼續上次</button>
        <button class="btn btn-ghost" id="previewBtn" type="button">先看看測驗會問什麼</button>
      </div>
      <details class="intro-details" id="quizPreview">
        <summary>測驗會問什麼</summary>
        <ul>
          <li>出生星期與星座（快速定位個人能量）</li>
          <li>7 題生活與意圖題（推導最合拍的守護神）</li>
          <li>結果會給你下一步建議（寺廟、商品、內容）</li>
        </ul>
      </details>
      <div class="save-hint" id="saveHint" style="display:none;">已自動保存作答</div>
    </section>

    <section class="quiz-flow" id="quizFlow" hidden>
      <div class="flow-head">
        <button type="button" class="btn btn-ghost" id="backBtn">← 上一題</button>
        <div class="progress" aria-live="polite">
          <div class="progress-label" id="progressLabel">步驟 1/9</div>
          <div class="progress-bar" aria-hidden="true"><span id="progressFill"></span></div>
        </div>
        <button type="button" class="btn btn-ghost" id="restartBtn">重新開始</button>
      </div>

      <div class="card question-card step-card" id="stepDow">
        <fieldset class="option-fieldset">
          <legend>你是星期幾出生？</legend>
          <div id="dowBox" class="option-grid" role="radiogroup" aria-label="weekday"></div>
        </fieldset>
      </div>

      <div class="card question-card step-card" id="stepZod">
        <fieldset class="option-fieldset">
          <legend>你的星座？</legend>
          <div id="zodiacBox" class="option-grid" role="radiogroup" aria-label="zodiac"></div>
        </fieldset>
      </div>

      <div class="card question-card step-card" id="quizBox">
        <fieldset class="option-fieldset">
          <legend id="qTitle"></legend>
          <div id="opts" class="option-grid" role="radiogroup" aria-label="question-options"></div>
        </fieldset>
      </div>

      <div class="flow-actions">
        <button id="nextStepBtn" class="btn btn-primary" type="button" disabled>下一步</button>
      </div>
    </section>

    <section class="card line-entry-card" id="lineFortuneEntry" style="display:none">
      <h2>已完成守護神測驗</h2>
      <p class="muted">系統已讀取你的守護神紀錄，可直接領取日籤或重新測驗。</p>
      <div id="lineGuardianBadge" class="guardian-badge" style="display:none;"></div>
      <div class="line-entry-actions">
        <button type="button" class="btn btn-ghost" id="lineRetakeBtn">重新測驗守護神</button>
      </div>
    </section>

    <section class="card result-card" id="resultBox" style="display:none">
      <div class="result-head">
        <div class="kicker">測驗結果</div>
        <h2 id="resultTitle">你的守護者</h2>
        <p class="muted" id="resultSummary">守護神正在為你指引下一步。</p>
      </div>
      <div class="result-grid">
        <div class="result-panel">
          <img id="deityImg" alt="守護神" crossorigin="anonymous" referrerpolicy="no-referrer" style="display:none;">
          <div class="result" id="resultText">尚未完成作答</div>
        </div>
        <div class="result-panel">
          <div class="step">緣分值</div>
          <div class="bar"><div id="affBar" class="fill"></div></div>
          <div id="affText" class="note" style="margin-top:6px"></div>
          <div class="step" style="margin-top:16px;">你的關鍵指引</div>
          <ul class="result-list" id="resultTraits"></ul>
        </div>
      </div>

      <div class="card advice-card">
        <div class="advice-head">
          <h3>佛牌配戴建議</h3>
          <button id="getCouponBtn" class="btn btn-primary">點我領取專屬優惠</button>
        </div>
        <div id="amuletAdvice" class="result" style="display:none">載入中…</div>
        <div id="couponWrap" class="result" style="display:none"></div>
        <div class="coupon-actions">
          <button id="copyCouponBtn" class="btn btn-ghost" style="display:none">複製優惠碼</button>
          <button id="saveCouponBtn" class="btn" style="display:none">存到我的優惠券</button>
        </div>
      </div>

      <div class="cta-actions">
        <a id="ctaTemple" class="btn btn-primary" href="/templemap">查看寺廟地圖</a>
        <a id="ctaShop" class="btn" href="/shop">前往選購專屬聖物</a>
      </div>
      <div class="cta-secondary">
        <a id="deityLink" target="_blank" rel="noopener" class="btn btn-ghost">查看完整介紹</a>
        <a id="menuLink" target="_blank" rel="noopener" class="btn btn-ghost">瀏覽其他守護者</a>
        <button id="shareLink" class="btn btn-ghost" type="button">複製分享連結</button>
        <button id="retakeBtn" class="btn btn-ghost" type="button">重新測驗一次</button>
      </div>
    </section>

    <dialog id="fortuneDialogQuiz" class="fortune-dialog">
      <div class="fortune-shell">
        <div class="fortune-head">
          <div>
            <div class="fortune-title">今日專屬日籤</div>
            <div class="fortune-date" id="fortuneDateQuiz">—</div>
          </div>
          <button type="button" class="fortune-close" id="fortuneCloseQuiz">✕</button>
        </div>
        <div class="fortune-body">
          <div id="fortuneLoadingQuiz" class="fortune-loading">正在翻牌中…</div>
          <div id="fortuneErrorQuiz" class="fortune-error" style="display:none;"></div>
          <div id="fortuneCardQuiz" class="fortune-card" style="display:none;">
            <div class="fortune-stars" id="fortuneStarsQuiz"></div>
            <div class="fortune-summary" id="fortuneSummaryQuiz"></div>
            <div class="fortune-section">
              <div class="fortune-label">生活小建議</div>
              <div class="fortune-text" id="fortuneAdviceQuiz"></div>
            </div>
            <div class="fortune-section">
              <div class="fortune-label" id="fortuneRitualLabelQuiz">守護神想對你說</div>
              <div class="fortune-text" id="fortuneRitualQuiz"></div>
            </div>
            <div class="fortune-meta" id="fortuneMetaQuiz"></div>
          </div>
        </div>
      </div>
    </dialog>
  </main>
  <script src="/js/quiz-index.inline-1.js"></script>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <script src="/js/auth.js?v=20240930"></script>
  <div id="resultLoading" class="loading-overlay" role="status" aria-live="polite">
    <div class="loading-card">
      <div class="loading-spinner" aria-hidden="true"></div>
      <div class="loading-title">守護神感應中…</div>
      <div class="loading-sub">請稍候</div>
    </div>
  </div>

<script src="/js/quiz-index.inline-2.js"></script>
</body>
</html>
