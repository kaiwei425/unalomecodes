<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>服務型商品｜unalomecodes</title>
  <link rel="stylesheet" href="/css/style.css">
  <style>
body.service-view{background:var(--bg);color:var(--fg);}
.service-top .service-actions{display:flex;gap:8px;flex-wrap:wrap;}
.service-top .service-actions .btn{border-radius:999px;padding:8px 14px;font-weight:700;border:1px solid var(--line);background:#fff;cursor:pointer;text-decoration:none;}
.service-top .service-actions .btn.primary{background:linear-gradient(135deg,#18a168,#1095d6);color:#fff;border-color:#1095d6;box-shadow:0 8px 18px rgba(16,149,214,.2);}
.service-hero{margin-top:14px;background:var(--card);border:1px solid var(--line);border-radius:18px;padding:22px;box-shadow:var(--shadow);}
.service-hero h1{margin:0;font-size:26px;font-weight:800;}
.svc-head{display:flex;justify-content:space-between;align-items:center;gap:12px;margin:22px 0 12px;}
.svc-head .title{font-weight:800;font-size:18px;}
.service-grid{margin-top:16px;}
.service-grid .card .meta{display:flex;gap:8px;flex-wrap:wrap;font-size:12px;color:var(--muted);margin:0;}
.service-grid .card .meta span{display:inline-flex;align-items:center;gap:4px;padding:2px 8px;border-radius:999px;background:#eef2ff;border:1px solid #c7d2fe;color:#1d4ed8;font-weight:600;}
.service-grid .card .price{font-size:18px;margin-top:6px;}
.service-grid .card .cta .btn{font-size:14px;}
.svc-dialog{border:none;border-radius:18px;padding:0;background:var(--card);color:var(--fg);box-shadow:0 30px 60px rgba(15,23,42,.3);border:1px solid var(--line);}
.svc-dialog .closeBar{border-bottom:1px solid var(--line);}
.svc-dialog .dlgBody{display:grid;grid-template-columns:1fr;gap:18px;padding:18px;}
@media(min-width:820px){.svc-dialog .dlgBody{grid-template-columns:1fr 1fr;}}
.svc-dialog .svc-includes{border:1px solid var(--line);border-radius:12px;padding:12px;margin-top:12px;list-style:disc;padding-left:22px;background:#f9fafb;}
.svc-dialog .svc-includes li{margin-bottom:6px;color:#374151;}
.svc-dialog .svc-options{display:flex;flex-direction:column;gap:6px;margin-top:10px;}
.svc-dialog .svc-options label{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:10px;
  border:1px solid var(--line);
  border-radius:10px;
  padding:6px 10px;
  font-size:14px;
  background:#f8fafc;
  width:100%;
}
.svc-dialog .svc-options label span{
  display:flex;
  align-items:center;
  gap:6px;
  flex:1;
  white-space:normal;
}
.svc-dialog .svc-options input{margin:0;flex-shrink:0;}
.svc-stepper{display:flex;gap:8px;justify-content:center;padding:14px;border-bottom:1px solid var(--line);background:linear-gradient(135deg,rgba(24,161,104,.08),rgba(16,149,214,.08));}
.svc-stepper span{display:flex;align-items:center;gap:6px;padding:6px 12px;border-radius:999px;border:1px solid var(--line);font-size:13px;color:#6b7280;font-weight:700;background:#fff;}
.svc-stepper span.active{background:#16a34a;color:#fff;border-color:#16a34a;box-shadow:0 8px 20px rgba(22,163,74,.35);}
.svc-stepper span.done{background:#bbf7d0;color:#166534;border-color:#86efac;}
.svc-step-content{display:none;flex-direction:column;gap:16px;padding:18px;}
.svc-step-content.active{display:flex;}
.svc-step-title{font-weight:800;font-size:18px;}
.svc-form-section{display:grid;gap:12px;}
.svc-bank-box{border:1px solid var(--line);border-radius:14px;padding:14px;background:#f8fafc;display:flex;flex-wrap:wrap;gap:12px;align-items:center;justify-content:space-between;}
.svc-bank-box .info{font-size:14px;color:#0f172a;font-weight:700;}
.svc-bank-box .info span{display:block;font-size:12px;color:#6b7280;font-weight:600;}
.svc-bank-copy{border:1px solid var(--line);background:#fff;border-radius:999px;padding:6px 12px;font-weight:700;font-size:13px;cursor:pointer;}
.svc-bank-hint{font-size:12px;color:#6b7280;line-height:1.6;}
.svc-upload-hint{font-size:12px;color:#ef4444;}
.svc-step-actions{display:flex;justify-content:flex-end;gap:10px;flex-wrap:wrap;}
.svc-step-actions .btn{min-width:120px;}
.svc-success-icon{width:64px;height:64px;border-radius:50%;background:#dcfce7;color:#166534;display:flex;align-items:center;justify-content:center;font-size:32px;margin:0 auto;}
.svc-step3-card{border:1px solid var(--line);border-radius:14px;background:#f8fafc;padding:14px;display:grid;gap:8px;font-size:14px;color:#374151;}
.svc-step3-card strong{font-size:16px;}
.svc-cart-item{display:flex;align-items:center;justify-content:space-between;border:1px solid var(--line);border-radius:14px;padding:10px;gap:12px;background:#fff;}
.svc-cart-item .info{display:flex;gap:10px;align-items:center;flex:1;}
.svc-cart-item img{width:56px;height:56px;object-fit:cover;border-radius:12px;}
.svc-cart-item .meta{font-size:12px;color:#6b7280;margin-top:2px;}
.svc-cart-item .price{font-weight:800;margin-right:10px;}
.svc-cart-remove{border:1px solid var(--line);background:#fff;border-radius:10px;padding:6px 12px;font-size:13px;font-weight:700;cursor:pointer;}
.svc-cart-actions{padding:0 18px 18px;display:flex;gap:8px;justify-content:flex-end;flex-wrap:wrap;margin-top:4px;}
.svc-cart-actions .btn{flex:1;min-width:120px;}
@media(max-width:560px){
  .svc-cart-item{flex-direction:column;align-items:flex-start;}
  .svc-cart-item .price{margin-right:0;}
  .svc-cart-actions .btn{flex:1 0 100%;}
}
#svcCartForm{padding:0;}
#svcCartForm section{padding:18px;display:grid;gap:12px;}
#svcCartForm label{display:grid;gap:4px;font-size:13px;color:#374151;font-weight:700;}
#svcCartForm input,#svcCartForm textarea,#svcCartForm select{padding:10px 12px;border:1px solid var(--line);border-radius:12px;font-size:14px;}
#svcCartForm textarea{min-height:110px;resize:vertical;}
.svc-summary{background:#f8fafc;border:1px solid var(--line);border-radius:14px;padding:14px;margin:18px;display:flex;justify-content:space-between;align-items:center;gap:10px;}
.svc-summary strong{font-size:18px;}
#svcLookup{border:none;border-radius:16px;padding:0;background:var(--card);border:1px solid var(--line);box-shadow:0 20px 50px rgba(15,23,42,.35);}
#svcLookup header{padding:18px;border-bottom:1px solid var(--line);}
#svcLookup form{padding:18px;display:grid;gap:12px;}
#svcLookup label{display:grid;gap:6px;font-size:13px;color:#374151;font-weight:600;}
#svcLookup input{padding:10px 12px;border:1px solid var(--line);border-radius:12px;}
#svcLookup .actions{padding:0 18px 18px;display:flex;justify-content:flex-end;gap:10px;}
#svcLookupResult{padding:0 18px 18px;}
#svcLookupCards .lookup-card{border:1px solid var(--line);border-radius:12px;padding:12px;background:#f8fafc;}
#svcSuccess .svc-success-body{padding:20px;display:grid;gap:12px;}
#svcSuccess .svc-success-body .order-id{font-size:22px;font-weight:800;}
#svcSuccess footer{padding:0 20px 20px;display:flex;justify-content:flex-end;gap:10px;}
  </style>
</head>
<body class="service-view">
  <div class="wrap service-page">
    <div class="top service-top">
      <div class="brand">
        <img src="https://i.ibb.co/7mtppQQ/logo.jpg" alt="">
        <div>
          <div class="t1">泰國寺廟map ©️ unalomecodes</div>
          <div class="t2">服務型商品專區（蠟燭祈福／遠距加持等）</div>
        </div>
      </div>
      <div class="service-actions"></div>
    </div>

    <div class="store service-layout">
      <aside id="sideDeities">
        <div class="side-cart">
          <button id="cartFab" type="button" title="查看購物車"><span class="lbl">服務購物車</span><span id="cartBadge">0</span></button>
        </div>
        <div class="tools-box">
          <h4>常用連結</h4>
          <div class="list">
            <a href="/shop.html">返回商品館</a>
            <a href="#" id="linkServiceLookup">祈福進度查詢</a>
            <a href="https://line.me/R/ti/p/@427oaemj" target="_blank" rel="noopener">官方 LINE 客服</a>
          </div>
        </div>
      </aside>

      <div class="main service-main">
        <section>
          <div id="svcList" class="grid service-grid">
            <div id="svcListEmpty">載入中…</div>
          </div>
        </section>
      </div>
    </div>

    <div class="footer">
      <strong>聯絡我們</strong><br>
      bkkaiwei@gmail.com<br>
      客服LINE official @427oaemj<br>
      2025©unalomecodes
    </div>
  </div>

  <dialog id="svcLookup">
    <header>
      <div style="font-weight:800;font-size:18px;">祈福進度查詢</div>
      <p style="margin:6px 0 0;color:#6b7280;font-size:13px;">輸入手機並搭配訂單編號末五碼或匯款帳號末五碼，即可查看服務最新狀態。</p>
    </header>
    <form id="svcLookupForm">
      <label>
        手機號碼
        <input type="tel" name="phone" required placeholder="請輸入下單時的電話" pattern="09\d{8}">
      </label>
      <label>
        訂單編號末五碼
        <input type="text" name="orderDigits" inputmode="numeric" pattern="\d{5}" placeholder="12345">
      </label>
      <label>
        匯款帳號末五碼
        <input type="text" name="bankDigits" inputmode="numeric" pattern="\d{5}" placeholder="12345">
      </label>
      <div class="actions">
        <button type="button" class="btn" id="svcLookupClose">關閉</button>
        <button type="submit" class="btn primary">查詢</button>
      </div>
      <p id="svcLookupHint" style="margin:0;font-size:12px;color:#94a3b8;">查詢結果載入後會顯示於下方。</p>
    </form>
    <div id="svcLookupResult" style="display:none;">
      <div style="font-weight:700;margin-bottom:6px;">查詢結果</div>
      <div id="svcLookupCards" style="display:flex;flex-direction:column;gap:10px;"></div>
    </div>
  </dialog>

  <dialog id="svcDetail" class="svc-dialog">
    <div class="closeBar">
      <strong id="svcDetailTitle">服務名稱</strong>
      <button id="svcDetailClose" class="xbtn" type="button">✕</button>
    </div>
    <div class="dlgBody">
      <div>
        <div class="bigBox">
          <img id="svcDetailHero" class="big" alt="">
        </div>
        <div class="thumbs" id="svcDetailGallery"></div>
      </div>
      <div>
        <div style="font-weight:700;color:#6b7280;margin-bottom:4px;">服務內容</div>
        <div id="svcDetailDesc" style="font-size:14px;line-height:1.7;border:1px solid var(--line);border-radius:12px;padding:12px;white-space:pre-wrap;max-height:220px;overflow:auto;">服務說明</div>
        <ul id="svcDetailIncludes" class="svc-includes">
          <li>蠟燭祈請</li>
        </ul>
        <div id="svcDetailOptionsWrap" style="margin-top:12px;">
          <label style="display:block;font-size:12px;color:#6b7280;margin-bottom:6px;">服務項目（選擇後加入購物車，可重複加入不同選項）</label>
          <select id="svcDetailVariant" style="width:100%;padding:10px;border-radius:10px;border:1px solid var(--line);font-size:14px;"></select>
        </div>
        <div style="margin-top:16px;font-weight:800;font-size:20px;color:#0f172a;">NT$ <span id="svcDetailPrice">0</span></div>
        <div style="margin-top:12px;">
          <button id="svcDetailAddCart" class="btn primary" style="width:100%;">加入購物車</button>
        </div>
      </div>
    </div>
  </dialog>

  <dialog id="svcCartPanel" style="border:none;border-radius:16px;padding:0;max-width:640px;width:95%;box-shadow:0 30px 60px rgba(15,23,42,.35);">
    <div style="display:flex;justify-content:space-between;align-items:center;padding:16px 18px;border-bottom:1px solid var(--line);">
      <div style="font-weight:800;font-size:18px;">服務購物車</div>
      <button type="button" id="svcCartPanelClose" class="xbtn">✕</button>
    </div>
    <div id="svcCartList" style="max-height:50vh;overflow:auto;padding:16px;display:flex;flex-direction:column;gap:10px;"></div>
    <div style="padding:0 18px 12px;">
      <div style="display:flex;justify-content:space-between;font-weight:700;">
        <span>應付金額</span>
        <span id="svcCartAmount">NT$ 0</span>
      </div>
    </div>
    <div class="svc-cart-actions">
      <button class="btn" id="svcCartPanelBack">返回上一頁</button>
      <button class="btn" id="svcCartClear">清空購物車</button>
      <button class="btn primary" id="svcCartCheckout">填寫訂單資料</button>
    </div>
  </dialog>

  <dialog id="svcCart" class="svc-dialog" data-bank-name="中國信託 (822)" data-bank-account="148540417073">
    <div class="svc-stepper">
      <span data-step="1" class="active">1. 確認服務</span>
      <span data-step="2">2. 匯款資料</span>
      <span data-step="3">3. 完成</span>
    </div>
    <form id="svcCartForm" class="svc-form" enctype="multipart/form-data">
      <input type="hidden" id="svcCartServiceId">
      <div class="svc-step-content active" id="svcCartStep1" data-step="1">
        <div>
          <div class="svc-step-title">確認服務與填寫基本資料</div>
          <p class="svc-bank-hint">請先確認服務內容，再填寫聯絡資訊與祈福需求，下一步即可查看匯款帳戶並上傳憑證。</p>
        </div>
        <div class="svc-summary">
          <div>
            <div style="font-size:12px;color:#6b7280;font-weight:700;">服務內容確認</div>
            <div id="svcCartServiceName" style="font-weight:700;font-size:16px;margin-top:4px;">服務名稱</div>
            <ul id="svcCartSummary" style="margin:6px 0 0;padding-left:18px;color:#475569;font-size:13px;line-height:1.5;"></ul>
          </div>
          <strong id="svcCartTotal">NT$ 0</strong>
        </div>
        <section class="svc-form-section">
          <label>
            聯絡人姓名（必填）
            <input type="text" name="name" required placeholder="請輸入姓名">
          </label>
          <label>
            手機號碼（必填）
            <input type="tel" name="phone" required placeholder="例：0969123456" inputmode="tel">
          </label>
          <label>
            Email（必填）
            <input type="email" name="email" required placeholder="請輸入通知用 Email">
          </label>
          <label>
            生日（西元年/月/日，必填）
            <input type="date" name="birth" required>
          </label>
          <label>
            指定祈福日期（可留白）
            <input type="date" name="requestDate">
            <span class="svc-bank-hint">如中午前完成下單，可選擇當日祈福；超過 12:00 請改選翌日以後。</span>
          </label>
          <label>
            備註
            <textarea name="note" placeholder="可輸入備註或特殊需求…"></textarea>
          </label>
          <label>
            上傳個人照片（祈福使用）
            <input type="file" id="svcContactPhoto" accept="image/*">
            <span class="svc-bank-hint">建議上傳清晰的正面照片，僅供老師祈福使用。</span>
            <span class="svc-bank-hint" id="svcContactPhotoName"></span>
          </label>
        </section>
        <div class="svc-step-actions">
          <button type="button" class="btn" id="svcCartBack">返回</button>
          <button type="button" class="btn primary" id="svcCartNext">前往匯款資料</button>
        </div>
      </div>

      <div class="svc-step-content" id="svcCartStep2" data-step="2">
        <div>
          <div class="svc-step-title">填寫匯款資料並上傳憑證</div>
          <p class="svc-bank-hint">請先完成轉帳，再輸入匯款末五碼並上傳匯款憑證，以便我們核帳、成立訂單。</p>
        </div>
        <div class="svc-bank-box">
          <div class="info">
            <span>匯款銀行</span>
            <strong id="svcBankName">中國信託 (822)</strong>
          </div>
          <div class="info">
            <span>匯款帳號</span>
            <strong id="svcBankAccount">148540417073</strong>
          </div>
          <button type="button" class="svc-bank-copy" id="svcBankCopy">複製帳號</button>
        </div>
        <section class="svc-form-section">
          <label>
            匯款金額（NT$）
            <input type="text" id="svcBankAmount" readonly>
            <span class="svc-bank-hint">系統自動帶入，請勿修改。</span>
          </label>
          <label>
            匯款末五碼
            <input type="text" id="svcBankLast5" placeholder="12345" inputmode="numeric" pattern="\d{5}" required>
          </label>
          <label>
            上傳匯款憑證（照片或截圖）
            <input type="file" id="svcBankReceipt" accept="image/*,application/pdf" required>
            <span class="svc-upload-hint">檔案需 20MB 以下，建議上傳清晰照片或 PDF。</span>
            <span class="svc-bank-hint" id="svcBankReceiptName"></span>
          </label>
          <label>
            匯款補充說明（可留白）
            <textarea id="svcBankMemo" placeholder="例：匯款人姓名與帳號、備註事項"></textarea>
          </label>
        </section>
        <div class="svc-step-actions">
          <button type="button" class="btn" id="svcBankBack">上一步</button>
          <button type="submit" id="svcBankSubmit" class="btn primary">送出匯款資料</button>
        </div>
      </div>

      <div class="svc-step-content" id="svcCartStep3" data-step="3">
        <div class="svc-success-icon">✓</div>
        <div style="text-align:center;">
          <div class="svc-step-title">訂單送出成功</div>
          <p class="svc-bank-hint">我們已收到匯款資料並建立祈福訂單，請保留以下資訊或截圖備查。</p>
        </div>
        <div class="svc-step3-card">
          <div><span style="font-size:12px;color:#6b7280;">訂單編號</span><strong id="svcStep3OrderId">SV000000</strong></div>
          <div>服務內容：<span id="svcStep3Service">—</span></div>
          <div>應付金額：<span id="svcStep3Amount">NT$ 0</span></div>
          <div>匯款末五碼：<span id="svcStep3Last5">—</span></div>
          <div>聯絡人：<span id="svcStep3Buyer">—</span></div>
        </div>
        <div class="svc-bank-hint">之後可透過左側「祈福進度查詢」輸入手機與訂單末五碼查詢最新進度。</div>
        <div class="svc-step-actions">
          <button type="button" class="btn" id="svcStep3Lookup">查詢進度</button>
          <button type="button" class="btn primary" id="svcStep3Close">完成</button>
        </div>
      </div>
    </form>
  </dialog>

  <dialog id="svcSuccess" class="svc-dialog">
    <div class="closeBar">
      <strong>祈福訂單已送出</strong>
      <button id="svcSuccessClose" class="xbtn" type="button">✕</button>
    </div>
    <div class="svc-success-body">
      <div>
        <div style="color:#6b7280;font-size:13px;">訂單編號</div>
        <div id="svcSuccessId" class="order-id">SV000000</div>
      </div>
      <div id="svcSuccessHint" style="font-size:14px;color:#374151;line-height:1.7;">
        我們會在指定時間完成祈福並透過 Email/LINE 通知，亦可使用左側「查祈福進度」功能查看最新狀態。
      </div>
    </div>
    <footer>
      <button class="btn" id="svcSuccessLookup">查詢進度</button>
    </footer>
  </dialog>

  <script src="/js/service-main.js"></script>
</body>
</html>
